(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var FileNavigator;

FileNavigator = function(file, options) {
  var decode, getProgress, lastPosition, navigator, readChunk, self, size;
  self = this;
  size = file.size;
  file.navigator = this;
  lastPosition = 0;
  getProgress = function() {
    var progress;
    if (!size || size === 0) {
      return 0;
    }
    progress = parseInt(100 * lastPosition / size);
    if (progress > 100) {
      return 100;
    } else {
      return progress;
    }
  };
  readChunk = function(offset, length, callback) {
    var reader;
    lastPosition = offset + length;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      var buffer;
      buffer = void 0;
      if (reader.result) {
        buffer = new Int8Array(reader.result, 0);
        buffer.slice = buffer.subarray;
      }
      callback(progress.err, buffer, progress.loaded);
    };
    reader.readAsArrayBuffer(file.slice(offset, offset + length));
  };
  decode = function(buffer, callback) {
    var reader;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      callback(progress.currentTarget.result);
    };
    reader.readAsText(new Blob([buffer]));
  };
  navigator = new LineNavigator(readChunk, decode, options);
  self.getMilestones = navigator.getMilestones;
  self.readSomeLines = function(index, callback) {
    navigator.readSomeLines(index, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.readLines = function(index, count, callback) {
    navigator.readLines(index, count, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.find = navigator.find;
  self.findAll = navigator.findAll;
  self.getSize = function(callback) {
    return callback(file ? file.size : 0);
  };
};

module.exports = FileNavigator;



},{}],2:[function(require,module,exports){
var FileNavigator, build_head_table2, cast, clear, convert_lines_to_json2, es_client, field_names, file, get_field_types, hosts, index_name, init_ui, linesReadHandler2, lines_in_batch, max_number_of_records, navigator, options, readFile, read_lines2, send_json_to_server2, show_progress, status, type_name, worker;

FileNavigator = require('./filenavigator.coffee');

hosts = "localhost:9200";

index_name = "govwiki";

type_name = "govs";

es_client = void 0;

field_names = [];

navigator = void 0;

file = void 0;

lines_in_batch = 10000;

max_number_of_records = 2000000000;

options = {
  chunkSize: 1024 * 1024 * 2
};

cast = void 0;

worker = void 0;

show_progress = function(progress, number) {
  var bar;
  bar = $(".progress-bar");
  bar.css("width", progress + "%");
  bar.text(progress + "%");
  $('#counter').text(number);
  return console.log(number + " : lines " + progress + "%");
};

build_head_table2 = function() {
  var container, head_navigator;
  container = $('#head_table_container');
  container.html("");
  head_navigator = new FileNavigator(file, {
    chunkSize: 1024 * 128
  });
  head_navigator.readLines(0, 3, function(err, index, lines, eof, progress) {
    var build_id_radio, build_table_body, build_table_row, build_type_selector, s;
    if (err) {
      return;
    }
    build_id_radio = function(name, i) {
      return "<input type=\"radio\" name=\"id_field\" value=\"" + name + "\">";
    };
    build_type_selector = function(name, i) {
      var if_number, if_string, v;
      if_string = function(v) {
        if (!v) {
          return "selected";
        }
        if (('' + v).indexOf('"') > -1) {
          return "selected";
        }
        return "";
      };
      if_number = function(v) {
        if (if_string(v) === "selected") {
          return "";
        } else {
          return "selected";
        }
      };
      v = lines[1].split(',')[i];
      return "<select class=\"type-selector form-control\" style=\"width:100px;\">\n  <option value=\"String\" " + (if_string(v)) + ">String</option>\n  <option value=\"Number\" " + (if_number(v)) + ">Number</option>\n  <option value=\"Boolean\">Boolean</option>\n</select> ";
    };
    build_table_row = function(name, i) {
      return "<tr>\n  <td class=\"first-column\">" + (build_id_radio(name, i)) + "</td>\n  <td>" + name + "</td>\n  <td style=\"width:120px;\">" + (build_type_selector(name, i)) + "</td>\n  <td>" + (lines[1].split(',')[i]) + "</td>\n</tr>";
    };
    build_table_body = function() {
      var i, name;
      return ((function() {
        var j, len, ref, results;
        ref = lines[0].replace(/"/g, '').split(',');
        results = [];
        for (i = j = 0, len = ref.length; j < len; i = ++j) {
          name = ref[i];
          results.push(build_table_row(name, i));
        }
        return results;
      })()).join('');
    };
    s = "<table class=\"table table-condensed\">\n  <thead>\n    <tr>\n      <th class=\"first-column\" style=\"width:70px;\"><input type=\"radio\" name=\"id_field\" value=\"\" checked>&nbsp;_id</th>\n      <th style=\"width:250px;\">name</th>\n      <th style=\"width:120px;\">type</th>\n      <th>sample</th>\n    </tr>\n  </thead>\n  <tbody>\n    " + (build_table_body()) + "\n  </tbody>\n</table>";
    container.html(s);
  });
};

init_ui = function() {
  file = document.getElementById('chooseFileButton').files[0];
  clear(worker);
  show_progress(0, 0);
  build_head_table2();
  $('.step-3').show();
  return $('.step-4').hide();
};

convert_lines_to_json2 = function(prm) {
  var field_values, i, j, len, line, operation, record, ref, res;
  importScripts('js/csv.js');
  if (!prm.lines) {
    return;
  }
  res = [];
  if (prm.index === 0) {
    prm.field_names = prm.lines[0].replace(/"/g, '').split(',');
    prm.lines.shift();
  }
  ref = prm.lines;
  for (i = j = 0, len = ref.length; j < len; i = ++j) {
    line = ref[i];
    if (prm.index + i > prm.max_number_of_records) {
      return res;
    }
    operation = {
      index: {
        _index: prm.index_name,
        _type: prm.type_name,
        _id: prm.index + i
      }
    };
    field_values = line.split(',');
    record = CSV.parse(line, {
      header: prm.field_names,
      cellDelimiter: ',',
      cast: prm.cast
    })[0];
    res.push(operation);
    res.push(record);
  }
  return res;
};

read_lines2 = function(i) {
  status('reading text');
  navigator.readSomeLines(i, linesReadHandler2);
};

send_json_to_server2 = function(index, lines, eof, progress, json) {
  if (index > max_number_of_records) {
    return;
  }
  if (json.length === 0) {
    return;
  }
  status((json.length / 2) + " sending");
  es_client.bulk({
    body: json
  }, (function(_this) {
    return function(err, resp) {
      if (err) {
        clear(worker);
        alert("Sorry, " + err.message);
        console.log(err);
        return;
      } else {
        status("");
        show_progress(progress, index + json.length / 2);
        if (eof) {
          clear(worker);
          return;
        }
        read_lines2(index + json.length / 2);
        return;
      }
    };
  })(this));
};

linesReadHandler2 = function(err, index, lines, eof, progress) {
  if (err) {
    clear(worker);
    return;
  }
  if (index > max_number_of_records) {
    clear(worker);
    return;
  }
  status(lines.length + " converting");
  worker.convert_lines_to_json2({
    index: index,
    lines: lines,
    field_names: field_names,
    max_number_of_records: max_number_of_records,
    index_name: index_name,
    type_name: type_name,
    cast: cast
  }).then(function(json) {
    send_json_to_server2(index, lines, eof, progress, json);
  });
};

clear = function(worker) {
  if (worker) {
    return worker.close();
  }
};

get_field_types = function() {
  var sel, sels, types;
  sels = $('.type-selector');
  types = (function() {
    var j, len, results;
    results = [];
    for (j = 0, len = sels.length; j < len; j++) {
      sel = sels[j];
      results.push(sel.value);
    }
    return results;
  })();
  return types;
};

readFile = function() {
  clear(worker);
  worker = cw({
    convert_lines_to_json2: convert_lines_to_json2
  });
  hosts = $('#hosts').val();
  index_name = $('#indexName').val();
  type_name = $('#typeName').val();
  es_client = new $.es.Client({
    hosts: hosts
  });
  cast = get_field_types();
  navigator = new FileNavigator(file, options);
  read_lines2(0);
  $('.step-4').show();
};

status = function(text) {
  return $('#status').text(text);
};

$('#chooseFileButton').change((function(_this) {
  return function() {
    return init_ui();
  };
})(this));

$('#readFileButton').click((function(_this) {
  return function() {
    return readFile();
  };
})(this));

$('.step-3').hide();

$('.step-4').hide();



},{"./filenavigator.coffee":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL2ZpbGVuYXZpZ2F0b3IuY29mZmVlIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL21haW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDUUEsSUFBQSxhQUFBOztBQUFBLGFBQUEsR0FBZ0IsU0FBQyxJQUFELEVBQU8sT0FBUCxHQUFBO0FBQ2QsTUFBQSxtRUFBQTtBQUFBLEVBQUEsSUFBQSxHQUFPLElBQVAsQ0FBQTtBQUFBLEVBQ0EsSUFBQSxHQUFPLElBQUksQ0FBQyxJQURaLENBQUE7QUFBQSxFQUVBLElBQUksQ0FBQyxTQUFMLEdBQWlCLElBRmpCLENBQUE7QUFBQSxFQUlBLFlBQUEsR0FBZSxDQUpmLENBQUE7QUFBQSxFQU1BLFdBQUEsR0FBYyxTQUFBLEdBQUE7QUFDWixRQUFBLFFBQUE7QUFBQSxJQUFBLElBQUcsQ0FBQSxJQUFBLElBQVMsSUFBQSxLQUFRLENBQXBCO0FBQ0UsYUFBTyxDQUFQLENBREY7S0FBQTtBQUFBLElBRUEsUUFBQSxHQUFXLFFBQUEsQ0FBUyxHQUFBLEdBQU0sWUFBTixHQUFxQixJQUE5QixDQUZYLENBQUE7QUFHQSxJQUFBLElBQUcsUUFBQSxHQUFXLEdBQWQ7YUFBdUIsSUFBdkI7S0FBQSxNQUFBO2FBQWdDLFNBQWhDO0tBSlk7RUFBQSxDQU5kLENBQUE7QUFBQSxFQWdCQSxTQUFBLEdBQVksU0FBQyxNQUFELEVBQVMsTUFBVCxFQUFpQixRQUFqQixHQUFBO0FBQ1YsUUFBQSxNQUFBO0FBQUEsSUFBQSxZQUFBLEdBQWUsTUFBQSxHQUFT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QSxDQUFFLFNBQUYsQ0FBWSxDQUFDLElBQWIsQ0FBQSxDQWxQQSxDQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuIyBBbGxvd3MgdG8gbmF2aWdhdGUgZ2l2ZW4gc291cmNlcyBsaW5lcywgc2F2aW5nIG1pbGVzdG9uZXMgdG8gb3B0aW1pemUgcmFuZG9tIHJlYWRpbmdcbiMgb3B0aW9ucyA9IHtcbiMgICAgICAgIG1pbGVzdG9uZXM6IFtdLCAgICAgICAgIC8vIG9wdGlvbmFsOiBhcnJheSBvZiBtaWxlc3RvbmVzLCB3aGljaCBjYW4gYmUgb2J0YWluZWQgYnkgZ2V0TWlsZXN0b25lcygpIG1ldGhvZCBhbmQgc3RvcmVkIHRvIHNwZWVkIHVwIHJhbmRvbSByZWFkaW5nIGluIGZ1dHVyZVxuIyAgICAgICAgY2h1bmtTaXplOiAxMDI0ICogNCwgICAgLy8gb3B0aW9uYWw6IHNpemUgb2YgY2h1bmsgdG8gcmVhZCBhdCBvbmNlXG4jIH1cblxuXG5GaWxlTmF2aWdhdG9yID0gKGZpbGUsIG9wdGlvbnMpIC0+XG4gIHNlbGYgPSB0aGlzXG4gIHNpemUgPSBmaWxlLnNpemVcbiAgZmlsZS5uYXZpZ2F0b3IgPSB0aGlzXG4gICMgcmV1c2UgbWlsZXN0b25lcyBsYXRlclxuICBsYXN0UG9zaXRpb24gPSAwXG5cbiAgZ2V0UHJvZ3Jlc3MgPSAtPlxuICAgIGlmICFzaXplIG9yIHNpemUgPT0gMFxuICAgICAgcmV0dXJuIDBcbiAgICBwcm9ncmVzcyA9IHBhcnNlSW50KDEwMCAqIGxhc3RQb3NpdGlvbiAvIHNpemUpXG4gICAgaWYgcHJvZ3Jlc3MgPiAxMDAgdGhlbiAxMDAgZWxzZSBwcm9ncmVzc1xuXG5cblxuICAjIGNhbGxiYWNrKGVyciwgYnVmZmVyLCBieXRlc1JlYWQpXG5cbiAgcmVhZENodW5rID0gKG9mZnNldCwgbGVuZ3RoLCBjYWxsYmFjaykgLT5cbiAgICBsYXN0UG9zaXRpb24gPSBvZmZzZXQgKyBsZW5ndGhcbiAgICByZWFkZXIgPSBuZXcgRmlsZVJlYWRlclxuXG4gICAgcmVhZGVyLm9ubG9hZGVuZCA9IChwcm9ncmVzcykgLT5cbiAgICAgIGJ1ZmZlciA9IHVuZGVmaW5lZFxuICAgICAgaWYgcmVhZGVyLnJlc3VsdFxuICAgICAgICBidWZmZXIgPSBuZXcgSW50OEFycmF5KHJlYWRlci5yZXN1bHQsIDApXG4gICAgICAgIGJ1ZmZlci5zbGljZSA9IGJ1ZmZlci5zdWJhcnJheVxuICAgICAgY2FsbGJhY2sgcHJvZ3Jlc3MuZXJyLCBidWZmZXIsIHByb2dyZXNzLmxvYWRlZFxuICAgICAgcmV0dXJuXG5cbiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIgZmlsZS5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aClcbiAgICByZXR1cm5cblxuXG5cbiAgIyBjYWxsYmFjayhzdHIpO1xuXG4gIGRlY29kZSA9IChidWZmZXIsIGNhbGxiYWNrKSAtPlxuICAgIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyXG5cbiAgICByZWFkZXIub25sb2FkZW5kID0gKHByb2dyZXNzKSAtPlxuICAgICAgY2FsbGJhY2sgcHJvZ3Jlc3MuY3VycmVudFRhcmdldC5yZXN1bHRcbiAgICAgIHJldHVyblxuXG4gICAgcmVhZGVyLnJlYWRBc1RleHQgbmV3IEJsb2IoWyBidWZmZXIgXSlcbiAgICByZXR1cm5cblxuICBuYXZpZ2F0b3IgPSBuZXcgTGluZU5hdmlnYXRvcihyZWFkQ2h1bmssIGRlY29kZSwgb3B0aW9ucylcblxuXG5cblxuICAjIFJldHVybnMgY3VycmVudCBtaWxlc3RvbmVzLCB0byBzcGVlZCB1cCBmaWxlIHJhbmRvbSByZWFkaW5nIGluIGZ1dHVyZVxuXG4gIHNlbGYuZ2V0TWlsZXN0b25lcyA9IG5hdmlnYXRvci5nZXRNaWxlc3RvbmVzXG5cblxuXG4gICMgUmVhZHMgb3B0aW1hbCBudW1iZXIgb2YgbGluZXNcbiAgIyBjYWxsYmFjazogZnVuY3Rpb24oZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpXG4gICMgd2hlcmUgcHJvZ3Jlc3MgaXMgMC0xMDAgJSBvZiBmaWxlIFxuXG4gIHNlbGYucmVhZFNvbWVMaW5lcyA9IChpbmRleCwgY2FsbGJhY2spIC0+XG4gICAgbmF2aWdhdG9yLnJlYWRTb21lTGluZXMgaW5kZXgsIChlcnIsIGluZGV4LCBsaW5lcywgZW9mKSAtPlxuICAgICAgY2FsbGJhY2sgZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgZ2V0UHJvZ3Jlc3MoKVxuICAgICAgcmV0dXJuXG4gICAgcmV0dXJuXG5cblxuXG4gICMgUmVhZHMgZXhhY3QgYW1vdW50IG9mIGxpbmVzXG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzKVxuICAjIHdoZXJlIHByb2dyZXNzIGlzIDAtMTAwICUgb2YgZmlsZSBcblxuICBzZWxmLnJlYWRMaW5lcyA9IChpbmRleCwgY291bnQsIGNhbGxiYWNrKSAtPlxuICAgIG5hdmlnYXRvci5yZWFkTGluZXMgaW5kZXgsIGNvdW50LCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZikgLT5cbiAgICAgIGNhbGxiYWNrIGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIGdldFByb2dyZXNzKClcbiAgICAgIHJldHVyblxuICAgIHJldHVyblxuXG5cblxuICAjIEZpbmRzIG5leHQgb2NjdXJyZW5jZSBvZiByZWd1bGFyIGV4cHJlc3Npb24gc3RhcnRpbmcgZnJvbSBnaXZlbiBpbmRleFxuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihlcnIsIGluZGV4LCBtYXRjaHtvZmZzZXQsIGxlbmd0aCwgbGluZX0pXG4gICMgb2Zmc2V0IGFuZCBsZW5ndGggYXJlIGJlbG9uZyB0byBtYXRjaCBpbnNpZGUgbGluZVxuXG4gIHNlbGYuZmluZCA9IG5hdmlnYXRvci5maW5kXG5cblxuXG4gICMgRmluZHMgYWxsIG9jY3VycmVuY2VzIG9mIHJlZ3VsYXIgZXhwcmVzc2lvbiBzdGFydGluZyBmcm9tIGdpdmVuIGluZGV4XG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbWl0SGl0LCByZXN1bHRzKVxuICAjIHJlc3VsdCBpcyBhbiBhcnJheSBvZiBvYmplY3RzIHdpdGggZm9sbG93aW5nIHN0cnVjdHVyZSB7aW5kZXgsIG9mZnNldCwgbGVuZ3RoLCBsaW5lfVxuICAjIG9mZnNldCBhbmQgbGVuZ3RoIGFyZSBiZWxvbmcgdG8gbWF0Y2ggaW5zaWRlIGxpbmVcblxuICBzZWxmLmZpbmRBbGwgPSBuYXZpZ2F0b3IuZmluZEFsbFxuXG5cbiAgIyBSZXR1cm5zIHNpemUgb2YgZmlsZSBpbiBieXRlc1xuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihzaXplKVxuXG4gIHNlbGYuZ2V0U2l6ZSA9IChjYWxsYmFjaykgLT5cbiAgICBjYWxsYmFjayBpZiBmaWxlIHRoZW4gZmlsZS5zaXplIGVsc2UgMFxuXG4gIHJldHVyblxuXG5cbm1vZHVsZS5leHBvcnRzPUZpbGVOYXZpZ2F0b3JcbiIsIkZpbGVOYXZpZ2F0b3IgPSByZXF1aXJlICcuL2ZpbGVuYXZpZ2F0b3IuY29mZmVlJ1xuIyBHbG9iYWxzXG5ob3N0cyA9IFwibG9jYWxob3N0OjkyMDBcIlxuaW5kZXhfbmFtZSA9IFwiZ292d2lraVwiXG50eXBlX25hbWUgPSBcImdvdnNcIlxuZXNfY2xpZW50ID0gdW5kZWZpbmVkXG5maWVsZF9uYW1lcyA9IFtdXG5cbm5hdmlnYXRvciA9IHVuZGVmaW5lZFxuZmlsZSA9IHVuZGVmaW5lZFxubGluZXNfaW5fYmF0Y2ggPTEwMDAwXG5tYXhfbnVtYmVyX29mX3JlY29yZHM9MjAwMDAwMDAwMFxuXG5vcHRpb25zID0ge2NodW5rU2l6ZTogMTAyNCAqIDEwMjQgKiAyfSAjIGNodW5rU2l6ZTogMTAyNCAqIDEwMjQgKiA0XG5jYXN0ID0gdW5kZWZpbmVkXG5cbndvcmtlcj11bmRlZmluZWRcblxuIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cblxuc2hvd19wcm9ncmVzcyA9IChwcm9ncmVzcyxudW1iZXIpIC0+XG4gIGJhcj0kKFwiLnByb2dyZXNzLWJhclwiKVxuICBiYXIuY3NzIFwid2lkdGhcIiwgXCIje3Byb2dyZXNzfSVcIlxuICBiYXIudGV4dCBcIiN7cHJvZ3Jlc3N9JVwiXG4gICQoJyNjb3VudGVyJykudGV4dCBudW1iZXJcbiAgY29uc29sZS5sb2cgXCIje251bWJlcn0gOiBsaW5lcyAje3Byb2dyZXNzfSVcIlxuXG5cblxuYnVpbGRfaGVhZF90YWJsZTIgPSgpIC0+XG4gIGNvbnRhaW5lciA9ICQoJyNoZWFkX3RhYmxlX2NvbnRhaW5lcicpXG4gIGNvbnRhaW5lci5odG1sIFwiXCJcbiAgaGVhZF9uYXZpZ2F0b3IgPSBuZXcgRmlsZU5hdmlnYXRvciBmaWxlLCAge2NodW5rU2l6ZTogMTAyNCAqIDEyOCB9XG4gIGhlYWRfbmF2aWdhdG9yLnJlYWRMaW5lcyAwLCAzLCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpIC0+XG5cbiAgICBpZiBlcnIgdGhlbiAgcmV0dXJuXG4gICAgXG4gICAgYnVpbGRfaWRfcmFkaW8gPSAobmFtZSxpKSAtPlxuICAgICAgXCJcIlwiXG4gICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImlkX2ZpZWxkXCIgdmFsdWU9XCIje25hbWV9XCI+XG4gICAgICBcIlwiXCJcblxuICAgIGJ1aWxkX3R5cGVfc2VsZWN0b3IgPSAobmFtZSxpKSAtPlxuICAgICAgXG4gICAgICBpZl9zdHJpbmcgPSh2KSAtPlxuICAgICAgICBpZiBub3QgdiB0aGVuIHJldHVybiBcInNlbGVjdGVkXCJcbiAgICAgICAgaWYgKCcnK3YpLmluZGV4T2YoJ1wiJykgPiAtMSB0aGVuIHJldHVybiBcInNlbGVjdGVkXCJcbiAgICAgICAgXCJcIlxuICAgICAgXG4gICAgICBpZl9udW1iZXIgPSh2KSAtPlxuICAgICAgICBpZiBpZl9zdHJpbmcodikgaXMgXCJzZWxlY3RlZFwiICB0aGVuIFwiXCIgZWxzZSBcInNlbGVjdGVkXCJcbiAgICAgIFxuICAgICAgdiA9IGxpbmVzWzFdLnNwbGl0KCcsJylbaV1cbiAgICAgIFwiXCJcIlxuICAgICAgPHNlbGVjdCBjbGFzcz1cInR5cGUtc2VsZWN0b3IgZm9ybS1jb250cm9sXCIgc3R5bGU9XCJ3aWR0aDoxMDBweDtcIj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlN0cmluZ1wiICN7aWZfc3RyaW5nKHYpfT5TdHJpbmc8L29wdGlvbj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIk51bWJlclwiICN7aWZfbnVtYmVyKHYpfT5OdW1iZXI8L29wdGlvbj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIkJvb2xlYW5cIj5Cb29sZWFuPC9vcHRpb24+XG4gICAgICA8L3NlbGVjdD4gXG4gICAgICBcIlwiXCJcblxuICAgIGJ1aWxkX3RhYmxlX3JvdyA9IChuYW1lLGkpIC0+XG4gICAgICBcIlwiXCJcbiAgICAgIDx0cj5cbiAgICAgICAgPHRkIGNsYXNzPVwiZmlyc3QtY29sdW1uXCI+I3tidWlsZF9pZF9yYWRpbyhuYW1lLGkpfTwvdGQ+XG4gICAgICAgIDx0ZD4je25hbWV9PC90ZD5cbiAgICAgICAgPHRkIHN0eWxlPVwid2lkdGg6MTIwcHg7XCI+I3tidWlsZF90eXBlX3NlbGVjdG9yKG5hbWUsaSl9PC90ZD5cbiAgICAgICAgPHRkPiN7bGluZXNbMV0uc3BsaXQoJywnKVtpXX08L3RkPlxuICAgICAgPC90cj5cbiAgICAgIFwiXCJcIlxuICAgIFxuXG4gICAgYnVpbGRfdGFibGVfYm9keSA9IC0+XG4gICAgICAoYnVpbGRfdGFibGVfcm93KG5hbWUsaSkgZm9yIG5hbWUsIGkgaW4gbGluZXNbMF0ucmVwbGFjZSgvXCIvZywnJykuc3BsaXQoJywnKSlcbiAgICAgIC5qb2luKCcnKVxuICAgIFxuICAgIFxuICAgIHMgPSBcIlwiXCJcbiAgICA8dGFibGUgY2xhc3M9XCJ0YWJsZSB0YWJsZS1jb25kZW5zZWRcIj5cbiAgICAgIDx0aGVhZD5cbiAgICAgICAgPHRyPlxuICAgICAgICAgIDx0aCBjbGFzcz1cImZpcnN0LWNvbHVtblwiIHN0eWxlPVwid2lkdGg6NzBweDtcIj48aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImlkX2ZpZWxkXCIgdmFsdWU9XCJcIiBjaGVja2VkPiZuYnNwO19pZDwvdGg+XG4gICAgICAgICAgPHRoIHN0eWxlPVwid2lkdGg6MjUwcHg7XCI+bmFtZTwvdGg+XG4gICAgICAgICAgPHRoIHN0eWxlPVwid2lkdGg6MTIwcHg7XCI+dHlwZTwvdGg+XG4gICAgICAgICAgPHRoPnNhbXBsZTwvdGg+XG4gICAgICAgIDwvdHI+XG4gICAgICA8L3RoZWFkPlxuICAgICAgPHRib2R5PlxuICAgICAgICAje2J1aWxkX3RhYmxlX2JvZHkoKX1cbiAgICAgIDwvdGJvZHk+XG4gICAgPC90YWJsZT5cbiAgICBcIlwiXCJcblxuICAgIGNvbnRhaW5lci5odG1sIHNcbiAgICByZXR1cm5cblxuXG4gIHJldHVyblxuXG4jIHByZXBhcmUgR1VJIGFmdGVyIHRoZSB1c2VyIHNlbGVjdHMgYSBmaWxlXG5pbml0X3VpID0gLT5cbiAgZmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9vc2VGaWxlQnV0dG9uJykuZmlsZXNbMF1cbiAgY2xlYXIgd29ya2VyXG4gIHNob3dfcHJvZ3Jlc3MgMCwwXG4gIGJ1aWxkX2hlYWRfdGFibGUyKClcbiAgJCgnLnN0ZXAtMycpLnNob3coKVxuICAkKCcuc3RlcC00JykuaGlkZSgpXG5cbiAgXG4jIGNvbnZlcnRzIHRleHQgdG8gSlNPTi4gUHJvY2Vzc29yIGNvbnN1bWluZyBvcGVyYXRpb24uIFRPRE86IG1vdmUgdG8gYSB3b3JrZXIuXG4jIHBybSBpcyB7IGluZGV4OmluZGV4LCBsaW5lczpsaW5lcywgZmllbGRfbmFtZXM6ZmllbGRfbmFtZXMsIFxuIyBtYXhfbnVtYmVyX29mX3JlY29yZHM6bWF4X251bWJlcl9vZl9yZWNvcmRzLCBpbmRleF9uYW1lOmluZGV4X25hbWUsIHR5cGVfbmFtZTp0eXBlX25hbWUsIGNhc3Q6Y2FzdCB9XG5jb252ZXJ0X2xpbmVzX3RvX2pzb24yID0ocHJtKSAtPlxuICBpbXBvcnRTY3JpcHRzKCdqcy9jc3YuanMnKVxuICBpZiBub3QgcHJtLmxpbmVzIHRoZW4gcmV0dXJuXG4gIHJlcyA9IFtdXG4gIGlmIHBybS5pbmRleCBpcyAwXG4gICAgcHJtLmZpZWxkX25hbWVzID0gcHJtLmxpbmVzWzBdLnJlcGxhY2UoL1wiL2csJycpLnNwbGl0ICcsJ1xuICAgIHBybS5saW5lcy5zaGlmdCgpXG5cbiAgZm9yIGxpbmUsaSBpbiBwcm0ubGluZXNcbiAgICBpZiBwcm0uaW5kZXgraSA+IHBybS5tYXhfbnVtYmVyX29mX3JlY29yZHMgdGhlbiByZXR1cm4gcmVzXG4gICAgb3BlcmF0aW9uID0geyBpbmRleDogIHsgX2luZGV4OiBwcm0uaW5kZXhfbmFtZSwgX3R5cGU6IHBybS50eXBlX25hbWUsIF9pZDogcHJtLmluZGV4K2kgfSB9XG4gICAgZmllbGRfdmFsdWVzID0gbGluZS5zcGxpdCAnLCdcbiAgICAjcmVjb3JkID0gXy5vYmplY3QgZmllbGRfbmFtZXMsIGZpZWxkX3ZhbHVlc1xuICAgIHJlY29yZCA9IENTVi5wYXJzZShsaW5lLCB7aGVhZGVyOiBwcm0uZmllbGRfbmFtZXMsIGNlbGxEZWxpbWl0ZXI6JywnLCBjYXN0OiBwcm0uY2FzdCB9KVswXVxuICAgIHJlcy5wdXNoIG9wZXJhdGlvblxuICAgIHJlcy5wdXNoIHJlY29yZFxuXG4gIHJldHVybiByZXNcblxuXG5cbiMgUmVhZGluZyBuZXh0IGNodW5rXG5yZWFkX2xpbmVzMiA9KGkpIC0+XG4gIHN0YXR1cyAncmVhZGluZyB0ZXh0J1xuICAjbmF2aWdhdG9yLnJlYWRMaW5lcyBpLCBsaW5lc19pbl9iYXRjaCwgIGxpbmVzUmVhZEhhbmRsZXJcbiAgbmF2aWdhdG9yLnJlYWRTb21lTGluZXMgaSwgIGxpbmVzUmVhZEhhbmRsZXIyXG4gIHJldHVyblxuXG5cbnNlbmRfanNvbl90b19zZXJ2ZXIyID0gKGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcywganNvbikgLT5cbiAgaWYgaW5kZXg+bWF4X251bWJlcl9vZl9yZWNvcmRzXG4gICAgcmV0dXJuXG4gIGlmIGpzb24ubGVuZ3RoIGlzIDBcbiAgICByZXR1cm5cblxuICBzdGF0dXMgXCIje2pzb24ubGVuZ3RoLzJ9IHNlbmRpbmdcIlxuICBlc19jbGllbnQuYnVsayB7IGJvZHk6IGpzb24gfSwgKGVyciwgcmVzcCkgPT5cblxuICAgIGlmIGVyclxuICAgICAgY2xlYXIgd29ya2VyXG4gICAgICBhbGVydCBcIlNvcnJ5LCAje2Vyci5tZXNzYWdlfVwiXG4gICAgICBjb25zb2xlLmxvZyBlcnJcbiAgICAgIHJldHVyblxuICAgIGVsc2VcbiAgICAgIHN0YXR1cyBcIlwiXG4gICAgICBzaG93X3Byb2dyZXNzKHByb2dyZXNzLCBpbmRleCtqc29uLmxlbmd0aC8yKSAjIGxpbmVzLmxlbmd0aClcbiAgICAgICNjb25zb2xlLmxvZyBcIiAje2pzb24ubGVuZ3RoLzJ9IGxpbmVzIHNlbnRcIlxuICAgICAgXG4gICAgICBpZiBlb2ZcbiAgICAgICAgY2xlYXIgd29ya2VyXG4gICAgICAgIHJldHVyblxuICAgICAgIyBhZGRpbmcgbnVtYmVyIG9mIGxpbmVzIHJlYWQgdG8gZmlyc3QgbGluZSBpbiBjdXJyZW50IGNodW5rXG4gICAgICByZWFkX2xpbmVzMiBpbmRleCArIGpzb24ubGVuZ3RoLzIgI2xpbmVzLmxlbmd0aFxuICAgICAgcmV0dXJuXG4gICAgcmV0dXJuXG5cbiAgcmV0dXJuXG5cblxuXG4gIFxuIyB3b3JrcyB3aGVuIGEgbmV4dCBwb3J0aW9uIG9mIGZpbGUgaGFzIGJlZW4gcmVhZFxubGluZXNSZWFkSGFuZGxlcjIgPSAoZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpIC0+XG4gIGlmIGVyclxuICAgIGNsZWFyIHdvcmtlclxuICAgIHJldHVyblxuICAgICAgICBcbiAgaWYgaW5kZXg+bWF4X251bWJlcl9vZl9yZWNvcmRzXG4gICAgY2xlYXIgd29ya2VyXG4gICAgcmV0dXJuXG4gIFxuICBzdGF0dXMgXCIje2xpbmVzLmxlbmd0aH0gY29udmVydGluZ1wiXG4gIHdvcmtlci5jb252ZXJ0X2xpbmVzX3RvX2pzb24yKHtcbiAgICBpbmRleDppbmRleCxcbiAgICBsaW5lczpsaW5lcyxcbiAgICBmaWVsZF9uYW1lczpmaWVsZF9uYW1lcyxcbiAgICBtYXhfbnVtYmVyX29mX3JlY29yZHM6bWF4X251bWJlcl9vZl9yZWNvcmRzLFxuICAgIGluZGV4X25hbWU6aW5kZXhfbmFtZSxcbiAgICB0eXBlX25hbWU6dHlwZV9uYW1lLFxuICAgIGNhc3Q6Y2FzdFxuICB9KVxuICAudGhlbiAoanNvbikgLT5cbiAgICBzZW5kX2pzb25fdG9fc2VydmVyMiBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MsIGpzb25cbiAgICByZXR1cm5cblxuICByZXR1cm5cblxuY2xlYXIgPSh3b3JrZXIpLT5cbiAgaWYgd29ya2VyXG4gICAgd29ya2VyLmNsb3NlKClcblxuXG5cbiMgcmV0dXJucyBhcnJheSBvZiBmZWlsZCB0eXBlcyB0byBzYXZlIGluIHRoZSBnbG9iYWwgY2FzdCB2YXJpYWJsZVxuZ2V0X2ZpZWxkX3R5cGVzID0oKSAtPlxuICBzZWxzID0kKCcudHlwZS1zZWxlY3RvcicpXG4gIHR5cGVzID0gKHNlbC52YWx1ZSBmb3Igc2VsIGluIHNlbHMpXG4gIHJldHVybiB0eXBlc1xuXG5cblxuIyBzdGFydHMgYWN0dWFsbHkgcmVhZCB0aGUgZmlsZSAgXG5yZWFkRmlsZSA9IC0+XG4gIGNsZWFyIHdvcmtlclxuICB3b3JrZXIgPSBjdyBjb252ZXJ0X2xpbmVzX3RvX2pzb24yOiBjb252ZXJ0X2xpbmVzX3RvX2pzb24yXG5cbiAgaG9zdHMgPSAkKCcjaG9zdHMnKS52YWwoKVxuICBpbmRleF9uYW1lID0gJCgnI2luZGV4TmFtZScpLnZhbCgpXG4gIHR5cGVfbmFtZSA9ICQoJyN0eXBlTmFtZScpLnZhbCgpXG5cbiAgZXNfY2xpZW50ID0gbmV3ICQuZXMuQ2xpZW50IGhvc3RzOiBob3N0c1xuICBcbiAgY2FzdCA9IGdldF9maWVsZF90eXBlcygpXG5cbiAgbmF2aWdhdG9yID0gbmV3IEZpbGVOYXZpZ2F0b3IoZmlsZSwgb3B0aW9ucylcbiAgcmVhZF9saW5lczIgMFxuICBcbiAgJCgnLnN0ZXAtNCcpLnNob3coKVxuICByZXR1cm5cblxuc3RhdHVzID0odGV4dCkgLT5cbiAgJCgnI3N0YXR1cycpLnRleHQodGV4dClcblxuIyBhc3NpZ24gaGFuZGxlcnMgdG8gVUkgXG4kKCcjY2hvb3NlRmlsZUJ1dHRvbicpLmNoYW5nZSA9PiBpbml0X3VpKClcbiQoJyNyZWFkRmlsZUJ1dHRvbicpLmNsaWNrID0+IHJlYWRGaWxlKClcblxuJCgnLnN0ZXAtMycpLmhpZGUoKVxuJCgnLnN0ZXAtNCcpLmhpZGUoKVxuXG5cbiJdfQ==
