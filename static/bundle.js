(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var FileNavigator;

FileNavigator = function(file, options) {
  var decode, getProgress, lastPosition, navigator, readChunk, self, size;
  self = this;
  size = file.size;
  file.navigator = this;
  lastPosition = 0;
  getProgress = function() {
    var progress;
    if (!size || size === 0) {
      return 0;
    }
    progress = parseInt(100 * lastPosition / size);
    if (progress > 100) {
      return 100;
    } else {
      return progress;
    }
  };
  readChunk = function(offset, length, callback) {
    var reader;
    lastPosition = offset + length;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      var buffer;
      buffer = void 0;
      if (reader.result) {
        buffer = new Int8Array(reader.result, 0);
        buffer.slice = buffer.subarray;
      }
      callback(progress.err, buffer, progress.loaded);
    };
    reader.readAsArrayBuffer(file.slice(offset, offset + length));
  };
  decode = function(buffer, callback) {
    var reader;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      callback(progress.currentTarget.result);
    };
    reader.readAsText(new Blob([buffer]));
  };
  navigator = new LineNavigator(readChunk, decode, options);
  self.getMilestones = navigator.getMilestones;
  self.readSomeLines = function(index, callback) {
    navigator.readSomeLines(index, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.readLines = function(index, count, callback) {
    navigator.readLines(index, count, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.find = navigator.find;
  self.findAll = navigator.findAll;
  self.getSize = function(callback) {
    return callback(file ? file.size : 0);
  };
};

module.exports = FileNavigator;



},{}],2:[function(require,module,exports){
var FileNavigator, build_head_table, cast, es_client, field_names, file, get_field_types, hosts, index_name, init_ui, linesReadHandler, lines_in_batch, max_number_of_records, navigator, options, prepare_json, readFile, read_lines, send_json_to_server, show_progress, type_name;

FileNavigator = require('./filenavigator.coffee');

hosts = "localhost:9200";

index_name = "govwiki";

type_name = "govs";

es_client = void 0;

field_names = [];

navigator = void 0;

file = void 0;

lines_in_batch = 10000;

max_number_of_records = 20000;

options = {
  chunkSize: 1024 * 1024 * 1
};

cast = void 0;

show_progress = function(progress, number) {
  var bar;
  bar = $(".progress-bar");
  bar.css("width", progress + "%");
  bar.text(progress + "%");
  $('#counter').text(number);
  return console.log(number + " : lines " + progress + "%");
};

build_head_table = function() {
  var container, head_navigator;
  container = $('#head_table_container');
  container.html("");
  head_navigator = new FileNavigator(file, {
    chunkSize: 1024 * 128
  });
  head_navigator.readLines(0, 3, function(err, index, lines, eof, progress) {
    var build_data_row, build_field_names_row, build_field_types_row, s;
    if (err) {
      return;
    }
    build_field_names_row = function(line) {
      var name, names, td;
      td = function(name) {
        return "<th>" + (name.replace(/"/g, '')) + "</th>";
      };
      names = line.split(',');
      return ((function() {
        var j, len, results;
        results = [];
        for (j = 0, len = names.length; j < len; j++) {
          name = names[j];
          results.push(td(name));
        }
        return results;
      })()).join("");
    };
    build_field_types_row = function(line) {
      var if_number, if_string, td, value, values;
      if_string = function(v) {
        if (!v) {
          return "selected";
        }
        if (('' + v).indexOf('"') > -1) {
          return "selected";
        }
        return "";
      };
      if_number = function(v) {
        if (if_string(v) === "selected") {
          return "";
        } else {
          return "selected";
        }
      };
      td = function(v) {
        return "<td>\n  <select class=\"type-selector\">\n    <option value=\"String\" " + (if_string(v)) + ">String</option>\n    <option value=\"Number\" " + (if_number(v)) + ">Number</option>\n    <option value=\"Boolean\">Boolean</option>\n  </select> \n</td>";
      };
      values = line.split(',');
      return ((function() {
        var j, len, results;
        results = [];
        for (j = 0, len = values.length; j < len; j++) {
          value = values[j];
          results.push(td(value));
        }
        return results;
      })()).join("");
    };
    build_data_row = function(line) {
      var td, value, values;
      td = function(v) {
        return "<td>" + v + "</td>";
      };
      values = line.split(',');
      return ((function() {
        var j, len, results;
        results = [];
        for (j = 0, len = values.length; j < len; j++) {
          value = values[j];
          results.push(td(value));
        }
        return results;
      })()).join("");
    };
    s = "<table style=\"border:1px solid silver;\">\n  <thead>\n    <tr>" + (build_field_names_row(lines[0])) + "</tr>\n    <tr>" + (build_field_types_row(lines[1])) + "</tr>\n  </thead>\n  <tbody>\n    <tr>" + (build_data_row(lines[1])) + "</tr>\n    <tr>" + (build_data_row(lines[2])) + "</tr>\n  </tbody>\n</table>";
    console.log(s);
    container.html(s);
  });
};

init_ui = function() {
  file = document.getElementById('chooseFileButton').files[0];
  show_progress(0, 0);
  return build_head_table();
};

prepare_json = function(index, lines) {
  var field_values, i, j, len, line, operation, record, res;
  if (!lines) {
    return;
  }
  res = [];
  if (index === 0) {
    field_names = lines[0].replace(/"/g, '').split(',');
    lines.shift();
  }
  for (i = j = 0, len = lines.length; j < len; i = ++j) {
    line = lines[i];
    if (index + i > max_number_of_records) {
      return res;
    }
    operation = {
      index: {
        _index: index_name,
        _type: type_name,
        _id: index + i
      }
    };
    field_values = line.split(',');
    record = CSV.parse(line, {
      header: field_names,
      cellDelimiter: ',',
      cast: cast
    })[0];
    res.push(operation);
    res.push(record);
  }
  return res;
};

read_lines = function(i) {
  navigator.readSomeLines(i, linesReadHandler);
};

send_json_to_server = function(index, lines, eof, progress, json) {
  if (index > max_number_of_records) {
    return;
  }
  if (json.length === 0) {
    return;
  }
  es_client.bulk({
    body: json
  }, (function(_this) {
    return function(err, resp) {
      if (err) {
        alert("Sorry, " + err.message);
        console.log(err);
        return;
      } else {
        show_progress(progress, index + json.length / 2);
        console.log(" " + (json.length / 2) + " lines sent");
        if (eof) {
          return;
        }
        read_lines(index + json.length / 2);
        return;
      }
    };
  })(this));
};

linesReadHandler = function(err, index, lines, eof, progress) {
  var json;
  if (err) {
    return;
  }
  if (index > max_number_of_records) {
    return;
  }
  json = prepare_json(index, lines);
  send_json_to_server(index, lines, eof, progress, json);
};

get_field_types = function() {
  var sel, sels, types;
  sels = $('.type-selector');
  types = (function() {
    var j, len, results;
    results = [];
    for (j = 0, len = sels.length; j < len; j++) {
      sel = sels[j];
      results.push(sel.value);
    }
    return results;
  })();
  return types;
};

readFile = function() {
  hosts = $('#hosts').val();
  index_name = $('#indexName').val();
  type_name = $('#typeName').val();
  es_client = new $.es.Client({
    hosts: hosts
  });
  cast = get_field_types();
  navigator = new FileNavigator(file, options);
  read_lines(0);
};

$('#chooseFileButton').change((function(_this) {
  return function() {
    return init_ui();
  };
})(this));

$('#readFileButton').click((function(_this) {
  return function() {
    return readFile();
  };
})(this));



},{"./filenavigator.coffee":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL2ZpbGVuYXZpZ2F0b3IuY29mZmVlIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL21haW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDUUEsSUFBQSxhQUFBOztBQUFBLGFBQUEsR0FBZ0IsU0FBQyxJQUFELEVBQU8sT0FBUCxHQUFBO0FBQ2QsTUFBQSxtRUFBQTtBQUFBLEVBQUEsSUFBQSxHQUFPLElBQVAsQ0FBQTtBQUFBLEVBQ0EsSUFBQSxHQUFPLElBQUksQ0FBQyxJQURaLENBQUE7QUFBQSxFQUVBLElBQUksQ0FBQyxTQUFMLEdBQWlCLElBRmpCLENBQUE7QUFBQSxFQUlBLFlBQUEsR0FBZSxDQUpmLENBQUE7QUFBQSxFQU1BLFdBQUEsR0FBYyxTQUFBLEdBQUE7QUFDWixRQUFBLFFBQUE7QUFBQSxJQUFBLElBQUcsQ0FBQSxJQUFBLElBQVMsSUFBQSxLQUFRLENBQXBCO0FBQ0UsYUFBTyxDQUFQLENBREY7S0FBQTtBQUFBLElBRUEsUUFBQSxHQUFXLFFBQUEsQ0FBUyxHQUFBLEdBQU0sWUFBTixHQUFxQixJQUE5QixDQUZYLENBQUE7QUFHQSxJQUFBLElBQUcsUUFBQSxHQUFXLEdBQWQ7YUFBdUIsSUFBdkI7S0FBQSxNQUFBO2FBQWdDLFNBQWhDO0tBSlk7RUFBQSxDQU5kLENBQUE7QUFBQSxFQWdCQSxTQUFBLEdBQVksU0FBQyxNQUFELEVBQVMsTUFBVCxFQUFpQixRQUFqQixHQUFBO0FBQ1YsUUFBQSxNQUFBO0FBQUEsSUFBQSxZQUFBLEdBQWUsTUFBQSxHQUFTLE1BQXhCLENBQUE7QUFBQSxJQUNBLE1BQUEsR0FBUyxHQUFBLENBQUEsVUFEVCxDQUFBO0FBQUEsSUFHQSxNQUFNLENBQUMsU0FBUCxHQUFtQixTQUFDLFFBQUQsR0FBQTtBQUNqQixVQUFBLE1BQUE7QUFBQSxNQUFBLE1BQUEsR0FBUyxNQUFULENBQUE7QUFDQSxNQUFBLElBQUcsTUFBTSxDQUFDLE1BQVY7QUFDRSxRQUFBLE1BQUEsR0FBYSxJQUFBLFNBQUEsQ0FBVSxNQUFNLENBQUMsTUFBakIsRUFBeUIsQ0FBekIsQ0FBYixDQUFBO0FBQUEsUUFDQSxNQUFNLENBQUMsS0FBUCxHQUFlLE1BQU0sQ0FBQyxRQUR0QixDQURGO09BREE7QUFBQSxNQUlBLFFBQUEsQ0FBUyxRQUFRLENBQUMsR0FBbEIsRUFBdUIsTUFBdkIsRUFBK0IsUUFBUSxDQUFDLE1BQXhDLENBSkEsQ0FEaUI7SUFBQSxDQUhuQixDQUFBO0FBQUEsSUFXQSxNQUFNLENBQUMsaUJBQVAsQ0FBeUIsSUFBSSxDQUFDLEtBQUwsQ0FBVyxNQUFYLEVBQW1CLE1BQUEsR0FBUyxNQUE1QixDQUF6QixDQVhBLENBRFU7RUFBQSxDQWhCWixDQUFBO0FBQUEsRUFtQ0EsTUFBQSxHQUFTLFNBQUMsTUFBRCxFQUFTLFFBQVQsR0FBQTtBQUNQLFFBQUEsTUFBQTtBQUFBLElBQUEsTUFBQSxHQUFTLEdBQUEsQ0FBQSxVQUFULENBQUE7QUFBQSxJQUVBLE1BQU0sQ0FBQyxTQUFQLEdBQW1CLFNBQUMsUUFBRCxHQUFBO0FBQ2pCLE1BQUEsUUFBQSxDQUFTLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBaEMsQ0FBQSxDQURpQjtJQUFBLENBRm5CLENBQUE7QUFBQSxJQU1BLE1BQU0sQ0FBQyxVQUFQLENBQXNCLElBQUEsSUFBQSxDQUFLLENBQUUsTUFBRixDQUFMLENBQXRCLENBTkEsQ0FETztFQUFBLENBbkNULENBQUE7QUFBQSxFQTZDQSxTQUFBLEdBQWdCLElBQUEsYUFBQSxDQUFjLFNBQWQsRUFBeUIsTUFBekIsRUFBaUMsT0FBakMsQ0E3Q2hCLENBQUE7QUFBQSxFQW9EQSxJQUFJLENBQUMsYUFBTCxHQUFxQixTQUFTLENBQUMsYUFwRC9CLENBQUE7QUFBQSxFQTREQSxJQUFJLENBQUMsYUFBTCxHQUFxQixTQUFDLEtBQUQsRUFBUSxRQUFSLEdBQUE7QUFDbkIsSUFBQSxTQUFTLENBQUMsYUFBVixDQUF3QixLQUF4QixFQUErQixTQUFDLEdBQUQsRUFBTSxLQUFOLEVBQWEsS0FBYixFQUFvQixHQUFwQixHQUFBO0FBQzdCLE1BQUEsUUFBQSxDQUFTLEdBQVQsRUFBYyxLQUFkLEVBQXFCLEtBQXJCLEVBQTRCLEdBQTVCLEVBQWlDLFdBQUEsQ0FBQSxDQUFqQyxDQUFBLENBRDZCO0lBQUEsQ0FBL0IsQ0FBQSxDQURtQjtFQUFBLENBNURyQixDQUFBO0FBQUEsRUF3RUEsSUFBSSxDQUFDLFNBQUwsR0FBaUIsU0FBQyxLQUFELEVBQVEsS0FBUixFQUFlLFFBQWYsR0FBQTtBQUNmLElBQUEsU0FBUyxDQUFDLFNBQVYsQ0FBb0IsS0FBcEIsRUFBMkIsS0FBM0IsRUFBa0MsU0FBQyxHQUFELEVBQU0sS0FBTixFQUFhLEtBQWIsRUFBb0IsR0FBcEIsR0FBQTtBQUNoQyxNQUFBLFFBQUEsQ0FBUyxHQUFULEVBQWMsS0FBZCxFQUFxQixLQUFyQixFQUE0QixHQUE1QixFQUFpQyxXQUFBLENBQUEsQ0FBakMsQ0FBQSxDQURnQztJQUFBLENBQWxDLENBQUEsQ0FEZTtFQUFBLENBeEVqQixDQUFBO0FBQUEsRUFvRkEsSUFBSSxDQUFDLElBQUwsR0FBWSxTQUFTLENBQUMsSUFwRnRCLENBQUE7QUFBQSxFQTZGQSxJQUFJLENBQUMsT0FBTCxHQUFlLFNBQVMsQ0FBQyxPQTdGekIsQ0FBQTtBQUFBLEVBbUdBLElBQUksQ0FBQyxPQUFMLEdBQWUsU0FBQyxRQUFELEdBQUE7V0FDYixRQUFBLENBQVksSUFBSCxHQUFhLElBQUksQ0FBQyxJQUFsQixHQUE0QixDQUFyQyxFQURhO0VBQUEsQ0FuR2YsQ0FEYztBQUFBLENBQWhCLENBQUE7O0FBQUEsTUEwR00sQ0FBQyxPQUFQLEdBQWUsYUExR2YsQ0FBQTs7Ozs7QUNSQSxJQUFBLGdSQUFBOztBQUFBLGFBQUEsR0FBZ0IsT0FBQSxDQUFRLHdCQUFSLENBQWhCLENBQUE7O0FBQUEsS0FHQSxHQUFRLGdCQUhSLENBQUE7O0FBQUEsVUFJQSxHQUFhLFNBSmIsQ0FBQTs7QUFBQSxTQUtBLEdBQVksTUFMWixDQUFBOztBQUFBLFNBTUEsR0FBWSxNQU5aLENBQUE7O0FBQUEsV0FPQSxHQUFjLEVBUGQsQ0FBQTs7QUFBQSxTQVNBLEdBQVksTUFUWixDQUFBOztBQUFBLElBVUEsR0FBTyxNQVZQLENBQUE7O0FBQUEsY0FXQSxHQUFnQixLQVhoQixDQUFBOztBQUFBLHFCQVlBLEdBQXNCLEtBWnRCLENBQUE7O0FBQUEsT0FjQSxHQUFVO0FBQUEsRUFBQyxTQUFBLEVBQVcsSUFBQSxHQUFPLElBQVAsR0FBYyxDQUExQjtDQWRWLENBQUE7O0FBQUEsSUFlQSxHQUFPLE1BZlAsQ0FBQTs7QUFBQSxhQXFCQSxHQUFnQixTQUFDLFFBQUQsRUFBVSxNQUFWLEdBQUE7QUFDZCxNQUFBLEdBQUE7QUFBQSxFQUFBLEdBQUEsR0FBSSxDQUFBLENBQUUsZUFBRixDQUFKLENBQUE7QUFBQSxFQUNBLEdBQUcsQ0FBQyxHQUFKLENBQVEsT0FBUixFQUFvQixRQUFELEdBQVUsR0FBN0IsQ0FEQSxDQUFBO0FBQUEsRUFFQSxHQUFHLENBQUMsSUFBSixDQUFZLFFBQUQsR0FBVSxHQUFyQixDQUZBLENBQUE7QUFBQSxFQUdBLENBQUEsQ0FBRSxVQUFGLENBQWEsQ0FBQyxJQUFkLENBQW1CLE1BQW5CLENBSEEsQ0FBQTtTQUlBLE9BQU8sQ0FBQyxHQUFSLENBQWUsTUFBRCxHQUFRLFdBQVIsR0FBbUIsUUFBbkIsR0FBNEIsR0FBMUMsRUFMYztBQUFBLENBckJoQixDQUFBOztBQUFBLGdCQThCQSxHQUFrQixTQUFBLEdBQUE7QUFDaEIsTUFBQSx5QkFBQTtBQUFBLEVBQUEsU0FBQSxHQUFZLENBQUEsQ0FBRSx1QkFBRixDQUFaLENBQUE7QUFBQSxFQUNBLFNBQVMsQ0FBQyxJQUFWLENBQWUsRUFBZixDQURBLENBQUE7QUFBQSxFQUVBLGNBQUEsR0FBcUIsSUFBQSxhQUFBLENBQWMsSUFBZCxFQUFxQjtBQUFBLElBQUMsU0FBQSxFQUFXLElBQUEsR0FBTyxHQUFuQjtHQUFyQixDQUZyQixDQUFBO0FBQUEsRUFHQSxjQUFjLENBQUMsU0FBZixDQUF5QixDQUF6QixFQUE0QixDQUE1QixFQUErQixTQUFDLEdBQUQsRUFBTSxLQUFOLEVBQWEsS0FBYixFQUFvQixHQUFwQixFQUF5QixRQUF6QixHQUFBO0FBQzdCLFFBQUEsK0RBQUE7QUFBQSxJQUFBLElBQUcsR0FBSDtBQUFhLFlBQUEsQ0FBYjtLQUFBO0FBQUEsSUFFQSxxQkFBQSxHQUF3QixTQUFDLElBQUQsR0FBQTtBQUN0QixVQUFBLGVBQUE7QUFBQSxNQUFBLEVBQUEsR0FBSyxTQUFDLElBQUQsR0FBQTtlQUFVLE1BQUEsR0FBTSxDQUFDLElBQUksQ0FBQyxPQUFMLENBQWEsSUFBYixFQUFrQixFQUFsQixDQUFELENBQU4sR0FBNkIsUUFBdkM7TUFBQSxDQUFMLENBQUE7QUFBQSxNQUNBLEtBQUEsR0FBTyxJQUFJLENBQUMsS0FBTCxDQUFXLEdBQVgsQ0FEUCxDQUFBO2FBRUE7O0FBQUM7YUFBQSx1Q0FBQTswQkFBQTtBQUFBLHVCQUFBLEVBQUEsQ0FBRyxJQUFILEVBQUEsQ0FBQTtBQUFBOztVQUFELENBQTRCLENBQUMsSUFBN0IsQ0FBa0MsRUFBbEMsRUFIc0I7SUFBQSxDQUZ4QixDQUFBO0FBQUEsSUFRQSxxQkFBQSxHQUF3QixTQUFDLElBQUQsR0FBQTtBQUN0QixVQUFBLHVDQUFBO0FBQUEsTUFBQSxTQUFBLEdBQVcsU0FBQyxDQUFELEdBQUE7QUFDVCxRQUFBLElBQUcsQ0FBQSxDQUFIO0FBQWMsaUJBQU8sVUFBUCxDQUFkO1NBQUE7QUFDQSxRQUFBLElBQUcsQ0FBQyxFQUFBLEdBQUcsQ0FBSixDQUFNLENBQUMsT0FBUCxDQUFlLEdBQWYsQ0FBQSxHQUFzQixDQUFBLENBQXpCO0FBQWlDLGlCQUFPLFVBQVAsQ0FBakM7U0FEQTtlQUVBLEdBSFM7TUFBQSxDQUFYLENBQUE7QUFBQSxNQUtBLFNBQUEsR0FBVyxTQUFDLENBQUQsR0FBQTtBQUNULFFBQUEsSUFBRyxTQUFBLENBQVUsQ0FBVixDQUFBLEtBQWdCLFVBQW5CO2lCQUFvQyxHQUFwQztTQUFBLE1BQUE7aUJBQTRDLFdBQTVDO1NBRFM7TUFBQSxDQUxYLENBQUE7QUFBQSxNQVNBLEVBQUEsR0FBSyxTQUFDLENBQUQsR0FBQTtlQUNILHlFQUFBLEdBRzRCLENBQUMsU0FBQSxDQUFVLENBQVYsQ0FBRCxDQUg1QixHQUcwQyxpREFIMUMsR0FJNEIsQ0FBQyxTQUFBLENBQVUsQ0FBVixDQUFELENBSjVCLEdBSTBDLHdGQUx2QztNQUFBLENBVEwsQ0FBQTtBQUFBLE1BbUJBLE1BQUEsR0FBUyxJQUFJLENBQUMsS0FBTCxDQUFXLEdBQVgsQ0FuQlQsQ0FBQTthQW9CQTs7QUFBQzthQUFBLHdDQUFBOzRCQUFBO0FBQUEsdUJBQUEsRUFBQSxDQUFHLEtBQUgsRUFBQSxDQUFBO0FBQUE7O1VBQUQsQ0FBK0IsQ0FBQyxJQUFoQyxDQUFxQyxFQUFyQyxFQXJCc0I7SUFBQSxDQVJ4QixDQUFBO0FBQUEsSUFnQ0EsY0FBQSxHQUFpQixTQUFDLElBQUQsR0FBQTtBQUNmLFVBQUEsaUJBQUE7QUFBQSxNQUFBLEVBQUEsR0FBSyxTQUFDLENBQUQsR0FBQTtlQUFPLE1BQUEsR0FBTyxDQUFQLEdBQVMsUUFBaEI7TUFBQSxDQUFMLENBQUE7QUFBQSxNQUNBLE1BQUEsR0FBUyxJQUFJLENBQUMsS0FBTCxDQUFXLEdBQVgsQ0FEVCxDQUFBO2FBRUE7O0FBQUM7YUFBQSx3Q0FBQTs0QkFBQTtBQUFBLHVCQUFBLEVBQUEsQ0FBRyxLQUFILEVBQUEsQ0FBQTtBQUFBOztVQUFELENBQStCLENBQUMsSUFBaEMsQ0FBcUMsRUFBckMsRUFIZTtJQUFBLENBaENqQixDQUFBO0FBQUEsSUFzQ0EsQ0FBQSxHQUFJLGlFQUFBLEdBR0ssQ0FBQyxxQkFBQSxDQUFzQixLQUFNLENBQUEsQ0FBQSxDQUE1QixDQUFELENBSEwsR0FHc0MsaUJBSHRDLEdBSUssQ0FBQyxxQkFBQSxDQUFzQixLQUFNLENBQUEsQ0FBQSxDQUE1QixDQUFELENBSkwsR0FJc0Msd0NBSnRDLEdBT0ssQ0FBQyxjQUFBLENBQWUsS0FBTSxDQUFBLENBQUEsQ0FBckIsQ0FBRCxDQVBMLEdBTytCLGlCQVAvQixHQVFLLENBQUMsY0FBQSxDQUFlLEtBQU0sQ0FBQSxDQUFBLENBQXJCLENBQUQsQ0FSTCxHQVErQiw2QkE5Q25DLENBQUE7QUFBQSxJQWtEQSxPQUFPLENBQUMsR0FBUixDQUFZLENBQVosQ0FsREEsQ0FBQTtBQUFBLElBbURBLFNBQVMsQ0FBQyxJQUFWLENBQWUsQ0FBZixDQW5EQSxDQUQ2QjtFQUFBLENBQS9CLENBSEEsQ0FEZ0I7QUFBQSxDQTlCbEIsQ0FBQTs7QUFBQSxPQTRGQSxHQUFVLFNBQUEsR0FBQTtBQUNSLEVBQUEsSUFBQSxHQUFPLFFBQVEsQ0FBQyxjQUFULENBQXdCLGtCQUF4QixDQUEyQyxDQUFDLEtBQU0sQ0FBQSxDQUFBLENBQXpELENBQUE7QUFBQSxFQUNBLGFBQUEsQ0FBYyxDQUFkLEVBQWdCLENBQWhCLENBREEsQ0FBQTtTQUVBLGdCQUFBLENBQUEsRUFIUTtBQUFBLENBNUZWLENBQUE7O0FBQUEsWUFtR0EsR0FBYyxTQUFDLEtBQUQsRUFBUSxLQUFSLEdBQUE7QUFDWixNQUFBLHFEQUFBO0FBQUEsRUFBQSxJQUFHLENBQUEsS0FBSDtBQUFrQixVQUFBLENBQWxCO0dBQUE7QUFBQSxFQUNBLEdBQUEsR0FBTSxFQUROLENBQUE7QUFFQSxFQUFBLElBQUcsS0FBQSxLQUFTLENBQVo7QUFDRSxJQUFBLFdBQUEsR0FBYyxLQUFNLENBQUEsQ0FBQSxDQUFFLENBQUMsT0FBVCxDQUFpQixJQUFqQixFQUFzQixFQUF0QixDQUF5QixDQUFDLEtBQTFCLENBQWdDLEdBQWhDLENBQWQsQ0FBQTtBQUFBLElBQ0EsS0FBSyxDQUFDLEtBQU4sQ0FBQSxDQURBLENBREY7R0FGQTtBQU1BLE9BQUEsK0NBQUE7b0JBQUE7QUFDRSxJQUFBLElBQUcsS0FBQSxHQUFNLENBQU4sR0FBVSxxQkFBYjtBQUF3QyxhQUFPLEdBQVAsQ0FBeEM7S0FBQTtBQUFBLElBQ0EsU0FBQSxHQUFZO0FBQUEsTUFBRSxLQUFBLEVBQVE7QUFBQSxRQUFFLE1BQUEsRUFBUSxVQUFWO0FBQUEsUUFBc0IsS0FBQSxFQUFPLFNBQTdCO0FBQUEsUUFBd0MsR0FBQSxFQUFLLEtBQUEsR0FBTSxDQUFuRDtPQUFWO0tBRFosQ0FBQTtBQUFBLElBRUEsWUFBQSxHQUFlLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBWCxDQUZmLENBQUE7QUFBQSxJQUlBLE1BQUEsR0FBUyxHQUFHLENBQUMsS0FBSixDQUFVLElBQVYsRUFBZ0I7QUFBQSxNQUFDLE1BQUEsRUFBUSxXQUFUO0FBQUEsTUFBc0IsYUFBQSxFQUFjLEdBQXBDO0FBQUEsTUFBeUMsSUFBQSxFQUFNLElBQS9DO0tBQWhCLENBQXVFLENBQUEsQ0FBQSxDQUpoRixDQUFBO0FBQUEsSUFLQSxHQUFHLENBQUMsSUFBSixDQUFTLFNBQVQsQ0FMQSxDQUFBO0FBQUEsSUFNQSxHQUFHLENBQUMsSUFBSixDQUFTLE1BQVQsQ0FOQSxDQURGO0FBQUEsR0FOQTtBQWVBLFNBQU8sR0FBUCxDQWhCWTtBQUFBLENBbkdkLENBQUE7O0FBQUEsVUF3SEEsR0FBWSxTQUFDLENBQUQsR0FBQTtBQUVWLEVBQUEsU0FBUyxDQUFDLGFBQVYsQ0FBd0IsQ0FBeEIsRUFBNEIsZ0JBQTVCLENBQUEsQ0FGVTtBQUFBLENBeEhaLENBQUE7O0FBQUEsbUJBK0hBLEdBQXNCLFNBQUMsS0FBRCxFQUFRLEtBQVIsRUFBZSxHQUFmLEVBQW9CLFFBQXBCLEVBQThCLElBQTlCLEdBQUE7QUFDcEIsRUFBQSxJQUFHLEtBQUEsR0FBTSxxQkFBVDtBQUNFLFVBQUEsQ0FERjtHQUFBO0FBRUEsRUFBQSxJQUFHLElBQUksQ0FBQyxNQUFMLEtBQWUsQ0FBbEI7QUFDRSxVQUFBLENBREY7R0FGQTtBQUFBLEVBS0EsU0FBUyxDQUFDLElBQVYsQ0FBZTtBQUFBLElBQUUsSUFBQSxFQUFNLElBQVI7R0FBZixFQUErQixDQUFBLFNBQUEsS0FBQSxHQUFBO1dBQUEsU0FBQyxHQUFELEVBQU0sSUFBTixHQUFBO0FBRTdCLE1BQUEsSUFBRyxHQUFIO0FBQ0UsUUFBQSxLQUFBLENBQU0sU0FBQSxHQUFVLEdBQUcsQ0FBQyxPQUFwQixDQUFBLENBQUE7QUFBQSxRQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksR0FBWixDQURBLENBQUE7QUFFQSxjQUFBLENBSEY7T0FBQSxNQUFBO0FBS0UsUUFBQSxhQUFBLENBQWMsUUFBZCxFQUF3QixLQUFBLEdBQU0sSUFBSSxDQUFDLE1BQUwsR0FBWSxDQUExQyxDQUFBLENBQUE7QUFBQSxRQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksR0FBQSxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQUwsR0FBWSxDQUFiLENBQUgsR0FBa0IsYUFBOUIsQ0FEQSxDQUFBO0FBR0EsUUFBQSxJQUFHLEdBQUg7QUFBWSxnQkFBQSxDQUFaO1NBSEE7QUFBQSxRQUtBLFVBQUEsQ0FBVyxLQUFBLEdBQVEsSUFBSSxDQUFDLE1BQUwsR0FBWSxDQUEvQixDQUxBLENBQUE7QUFNQSxjQUFBLENBWEY7T0FGNkI7SUFBQSxFQUFBO0VBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUEvQixDQUxBLENBRG9CO0FBQUEsQ0EvSHRCLENBQUE7O0FBQUEsZ0JBNEpBLEdBQW1CLFNBQUMsR0FBRCxFQUFNLEtBQU4sRUFBYSxLQUFiLEVBQW9CLEdBQXBCLEVBQXlCLFFBQXpCLEdBQUE7QUFDakIsTUFBQSxJQUFBO0FBQUEsRUFBQSxJQUFHLEdBQUg7QUFBYSxVQUFBLENBQWI7R0FBQTtBQUNBLEVBQUEsSUFBRyxLQUFBLEdBQU0scUJBQVQ7QUFDRSxVQUFBLENBREY7R0FEQTtBQUFBLEVBR0EsSUFBQSxHQUFPLFlBQUEsQ0FBYSxLQUFiLEVBQW9CLEtBQXBCLENBSFAsQ0FBQTtBQUFBLEVBSUEsbUJBQUEsQ0FBb0IsS0FBcEIsRUFBMkIsS0FBM0IsRUFBa0MsR0FBbEMsRUFBdUMsUUFBdkMsRUFBaUQsSUFBakQsQ0FKQSxDQURpQjtBQUFBLENBNUpuQixDQUFBOztBQUFBLGVBdUtBLEdBQWlCLFNBQUEsR0FBQTtBQUNmLE1BQUEsZ0JBQUE7QUFBQSxFQUFBLElBQUEsR0FBTSxDQUFBLENBQUUsZ0JBQUYsQ0FBTixDQUFBO0FBQUEsRUFDQSxLQUFBOztBQUFTO1NBQUEsc0NBQUE7b0JBQUE7QUFBQSxtQkFBQSxHQUFHLENBQUMsTUFBSixDQUFBO0FBQUE7O01BRFQsQ0FBQTtBQUVBLFNBQU8sS0FBUCxDQUhlO0FBQUEsQ0F2S2pCLENBQUE7O0FBQUEsUUErS0EsR0FBVyxTQUFBLEdBQUE7QUFDVCxFQUFBLEtBQUEsR0FBUSxDQUFBLENBQUUsUUFBRixDQUFXLENBQUMsR0FBWixDQUFBLENBQVIsQ0FBQTtBQUFBLEVBQ0EsVUFBQSxHQUFhLENBQUEsQ0FBRSxZQUFGLENBQWUsQ0FBQyxHQUFoQixDQUFBLENBRGIsQ0FBQTtBQUFBLEVBRUEsU0FBQSxHQUFZLENBQUEsQ0FBRSxXQUFGLENBQWMsQ0FBQyxHQUFmLENBQUEsQ0FGWixDQUFBO0FBQUEsRUFJQSxTQUFBLEdBQWdCLElBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFMLENBQVk7QUFBQSxJQUFBLEtBQUEsRUFBTyxLQUFQO0dBQVosQ0FKaEIsQ0FBQTtBQUFBLEVBTUEsSUFBQSxHQUFPLGVBQUEsQ0FBQSxDQU5QLENBQUE7QUFBQSxFQVFBLFNBQUEsR0FBZ0IsSUFBQSxhQUFBLENBQWMsSUFBZCxFQUFvQixPQUFwQixDQVJoQixDQUFBO0FBQUEsRUFTQSxVQUFBLENBQVcsQ0FBWCxDQVRBLENBRFM7QUFBQSxDQS9LWCxDQUFBOztBQUFBLENBK0xBLENBQUUsbUJBQUYsQ0FBc0IsQ0FBQyxNQUF2QixDQUE4QixDQUFBLFNBQUEsS0FBQSxHQUFBO1NBQUEsU0FBQSxHQUFBO1dBQUcsT0FBQSxDQUFBLEVBQUg7RUFBQSxFQUFBO0FBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUE5QixDQS9MQSxDQUFBOztBQUFBLENBZ01BLENBQUUsaUJBQUYsQ0FBb0IsQ0FBQyxLQUFyQixDQUEyQixDQUFBLFNBQUEsS0FBQSxHQUFBO1NBQUEsU0FBQSxHQUFBO1dBQUcsUUFBQSxDQUFBLEVBQUg7RUFBQSxFQUFBO0FBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUEzQixDQWhNQSxDQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuIyBBbGxvd3MgdG8gbmF2aWdhdGUgZ2l2ZW4gc291cmNlcyBsaW5lcywgc2F2aW5nIG1pbGVzdG9uZXMgdG8gb3B0aW1pemUgcmFuZG9tIHJlYWRpbmdcbiMgb3B0aW9ucyA9IHtcbiMgICAgICAgIG1pbGVzdG9uZXM6IFtdLCAgICAgICAgIC8vIG9wdGlvbmFsOiBhcnJheSBvZiBtaWxlc3RvbmVzLCB3aGljaCBjYW4gYmUgb2J0YWluZWQgYnkgZ2V0TWlsZXN0b25lcygpIG1ldGhvZCBhbmQgc3RvcmVkIHRvIHNwZWVkIHVwIHJhbmRvbSByZWFkaW5nIGluIGZ1dHVyZVxuIyAgICAgICAgY2h1bmtTaXplOiAxMDI0ICogNCwgICAgLy8gb3B0aW9uYWw6IHNpemUgb2YgY2h1bmsgdG8gcmVhZCBhdCBvbmNlXG4jIH1cblxuXG5GaWxlTmF2aWdhdG9yID0gKGZpbGUsIG9wdGlvbnMpIC0+XG4gIHNlbGYgPSB0aGlzXG4gIHNpemUgPSBmaWxlLnNpemVcbiAgZmlsZS5uYXZpZ2F0b3IgPSB0aGlzXG4gICMgcmV1c2UgbWlsZXN0b25lcyBsYXRlclxuICBsYXN0UG9zaXRpb24gPSAwXG5cbiAgZ2V0UHJvZ3Jlc3MgPSAtPlxuICAgIGlmICFzaXplIG9yIHNpemUgPT0gMFxuICAgICAgcmV0dXJuIDBcbiAgICBwcm9ncmVzcyA9IHBhcnNlSW50KDEwMCAqIGxhc3RQb3NpdGlvbiAvIHNpemUpXG4gICAgaWYgcHJvZ3Jlc3MgPiAxMDAgdGhlbiAxMDAgZWxzZSBwcm9ncmVzc1xuXG5cblxuICAjIGNhbGxiYWNrKGVyciwgYnVmZmVyLCBieXRlc1JlYWQpXG5cbiAgcmVhZENodW5rID0gKG9mZnNldCwgbGVuZ3RoLCBjYWxsYmFjaykgLT5cbiAgICBsYXN0UG9zaXRpb24gPSBvZmZzZXQgKyBsZW5ndGhcbiAgICByZWFkZXIgPSBuZXcgRmlsZVJlYWRlclxuXG4gICAgcmVhZGVyLm9ubG9hZGVuZCA9IChwcm9ncmVzcykgLT5cbiAgICAgIGJ1ZmZlciA9IHVuZGVmaW5lZFxuICAgICAgaWYgcmVhZGVyLnJlc3VsdFxuICAgICAgICBidWZmZXIgPSBuZXcgSW50OEFycmF5KHJlYWRlci5yZXN1bHQsIDApXG4gICAgICAgIGJ1ZmZlci5zbGljZSA9IGJ1ZmZlci5zdWJhcnJheVxuICAgICAgY2FsbGJhY2sgcHJvZ3Jlc3MuZXJyLCBidWZmZXIsIHByb2dyZXNzLmxvYWRlZFxuICAgICAgcmV0dXJuXG5cbiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIgZmlsZS5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aClcbiAgICByZXR1cm5cblxuXG5cbiAgIyBjYWxsYmFjayhzdHIpO1xuXG4gIGRlY29kZSA9IChidWZmZXIsIGNhbGxiYWNrKSAtPlxuICAgIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyXG5cbiAgICByZWFkZXIub25sb2FkZW5kID0gKHByb2dyZXNzKSAtPlxuICAgICAgY2FsbGJhY2sgcHJvZ3Jlc3MuY3VycmVudFRhcmdldC5yZXN1bHRcbiAgICAgIHJldHVyblxuXG4gICAgcmVhZGVyLnJlYWRBc1RleHQgbmV3IEJsb2IoWyBidWZmZXIgXSlcbiAgICByZXR1cm5cblxuICBuYXZpZ2F0b3IgPSBuZXcgTGluZU5hdmlnYXRvcihyZWFkQ2h1bmssIGRlY29kZSwgb3B0aW9ucylcblxuXG5cblxuICAjIFJldHVybnMgY3VycmVudCBtaWxlc3RvbmVzLCB0byBzcGVlZCB1cCBmaWxlIHJhbmRvbSByZWFkaW5nIGluIGZ1dHVyZVxuXG4gIHNlbGYuZ2V0TWlsZXN0b25lcyA9IG5hdmlnYXRvci5nZXRNaWxlc3RvbmVzXG5cblxuXG4gICMgUmVhZHMgb3B0aW1hbCBudW1iZXIgb2YgbGluZXNcbiAgIyBjYWxsYmFjazogZnVuY3Rpb24oZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpXG4gICMgd2hlcmUgcHJvZ3Jlc3MgaXMgMC0xMDAgJSBvZiBmaWxlIFxuXG4gIHNlbGYucmVhZFNvbWVMaW5lcyA9IChpbmRleCwgY2FsbGJhY2spIC0+XG4gICAgbmF2aWdhdG9yLnJlYWRTb21lTGluZXMgaW5kZXgsIChlcnIsIGluZGV4LCBsaW5lcywgZW9mKSAtPlxuICAgICAgY2FsbGJhY2sgZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgZ2V0UHJvZ3Jlc3MoKVxuICAgICAgcmV0dXJuXG4gICAgcmV0dXJuXG5cblxuXG4gICMgUmVhZHMgZXhhY3QgYW1vdW50IG9mIGxpbmVzXG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzKVxuICAjIHdoZXJlIHByb2dyZXNzIGlzIDAtMTAwICUgb2YgZmlsZSBcblxuICBzZWxmLnJlYWRMaW5lcyA9IChpbmRleCwgY291bnQsIGNhbGxiYWNrKSAtPlxuICAgIG5hdmlnYXRvci5yZWFkTGluZXMgaW5kZXgsIGNvdW50LCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZikgLT5cbiAgICAgIGNhbGxiYWNrIGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIGdldFByb2dyZXNzKClcbiAgICAgIHJldHVyblxuICAgIHJldHVyblxuXG5cblxuICAjIEZpbmRzIG5leHQgb2NjdXJyZW5jZSBvZiByZWd1bGFyIGV4cHJlc3Npb24gc3RhcnRpbmcgZnJvbSBnaXZlbiBpbmRleFxuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihlcnIsIGluZGV4LCBtYXRjaHtvZmZzZXQsIGxlbmd0aCwgbGluZX0pXG4gICMgb2Zmc2V0IGFuZCBsZW5ndGggYXJlIGJlbG9uZyB0byBtYXRjaCBpbnNpZGUgbGluZVxuXG4gIHNlbGYuZmluZCA9IG5hdmlnYXRvci5maW5kXG5cblxuXG4gICMgRmluZHMgYWxsIG9jY3VycmVuY2VzIG9mIHJlZ3VsYXIgZXhwcmVzc2lvbiBzdGFydGluZyBmcm9tIGdpdmVuIGluZGV4XG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbWl0SGl0LCByZXN1bHRzKVxuICAjIHJlc3VsdCBpcyBhbiBhcnJheSBvZiBvYmplY3RzIHdpdGggZm9sbG93aW5nIHN0cnVjdHVyZSB7aW5kZXgsIG9mZnNldCwgbGVuZ3RoLCBsaW5lfVxuICAjIG9mZnNldCBhbmQgbGVuZ3RoIGFyZSBiZWxvbmcgdG8gbWF0Y2ggaW5zaWRlIGxpbmVcblxuICBzZWxmLmZpbmRBbGwgPSBuYXZpZ2F0b3IuZmluZEFsbFxuXG5cbiAgIyBSZXR1cm5zIHNpemUgb2YgZmlsZSBpbiBieXRlc1xuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihzaXplKVxuXG4gIHNlbGYuZ2V0U2l6ZSA9IChjYWxsYmFjaykgLT5cbiAgICBjYWxsYmFjayBpZiBmaWxlIHRoZW4gZmlsZS5zaXplIGVsc2UgMFxuXG4gIHJldHVyblxuXG5cbm1vZHVsZS5leHBvcnRzPUZpbGVOYXZpZ2F0b3JcbiIsIkZpbGVOYXZpZ2F0b3IgPSByZXF1aXJlICcuL2ZpbGVuYXZpZ2F0b3IuY29mZmVlJ1xuXG4jIEdsb2JhbHNcbmhvc3RzID0gXCJsb2NhbGhvc3Q6OTIwMFwiXG5pbmRleF9uYW1lID0gXCJnb3Z3aWtpXCJcbnR5cGVfbmFtZSA9IFwiZ292c1wiXG5lc19jbGllbnQgPSB1bmRlZmluZWRcbmZpZWxkX25hbWVzID0gW11cblxubmF2aWdhdG9yID0gdW5kZWZpbmVkXG5maWxlID0gdW5kZWZpbmVkXG5saW5lc19pbl9iYXRjaCA9MTAwMDBcbm1heF9udW1iZXJfb2ZfcmVjb3Jkcz0yMDAwMFxuXG5vcHRpb25zID0ge2NodW5rU2l6ZTogMTAyNCAqIDEwMjQgKiAxfSAjIGNodW5rU2l6ZTogMTAyNCAqIDEwMjQgKiA0XG5jYXN0ID0gdW5kZWZpbmVkXG5cbiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG5cbnNob3dfcHJvZ3Jlc3MgPSAocHJvZ3Jlc3MsbnVtYmVyKSAtPlxuICBiYXI9JChcIi5wcm9ncmVzcy1iYXJcIilcbiAgYmFyLmNzcyBcIndpZHRoXCIsIFwiI3twcm9ncmVzc30lXCJcbiAgYmFyLnRleHQgXCIje3Byb2dyZXNzfSVcIlxuICAkKCcjY291bnRlcicpLnRleHQgbnVtYmVyXG4gIGNvbnNvbGUubG9nIFwiI3tudW1iZXJ9IDogbGluZXMgI3twcm9ncmVzc30lXCJcblxuXG5cbmJ1aWxkX2hlYWRfdGFibGUgPSgpIC0+XG4gIGNvbnRhaW5lciA9ICQoJyNoZWFkX3RhYmxlX2NvbnRhaW5lcicpXG4gIGNvbnRhaW5lci5odG1sIFwiXCJcbiAgaGVhZF9uYXZpZ2F0b3IgPSBuZXcgRmlsZU5hdmlnYXRvciBmaWxlLCAge2NodW5rU2l6ZTogMTAyNCAqIDEyOCB9XG4gIGhlYWRfbmF2aWdhdG9yLnJlYWRMaW5lcyAwLCAzLCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpIC0+XG4gICAgaWYgZXJyIHRoZW4gIHJldHVyblxuXG4gICAgYnVpbGRfZmllbGRfbmFtZXNfcm93ID0gKGxpbmUpIC0+XG4gICAgICB0ZCA9IChuYW1lKSAtPiBcIjx0aD4je25hbWUucmVwbGFjZSgvXCIvZywnJyl9PC90aD5cIlxuICAgICAgbmFtZXM9IGxpbmUuc3BsaXQgJywnXG4gICAgICAodGQobmFtZSkgZm9yIG5hbWUgaW4gbmFtZXMpLmpvaW4gXCJcIlxuXG4gICAgXG4gICAgYnVpbGRfZmllbGRfdHlwZXNfcm93ID0gKGxpbmUpIC0+XG4gICAgICBpZl9zdHJpbmcgPSh2KSAtPlxuICAgICAgICBpZiBub3QgdiB0aGVuIHJldHVybiBcInNlbGVjdGVkXCJcbiAgICAgICAgaWYgKCcnK3YpLmluZGV4T2YoJ1wiJykgPiAtMSB0aGVuIHJldHVybiBcInNlbGVjdGVkXCJcbiAgICAgICAgXCJcIlxuICAgICAgXG4gICAgICBpZl9udW1iZXIgPSh2KSAtPlxuICAgICAgICBpZiBpZl9zdHJpbmcodikgaXMgXCJzZWxlY3RlZFwiICB0aGVuIFwiXCIgZWxzZSBcInNlbGVjdGVkXCJcblxuXG4gICAgICB0ZCA9ICh2KSAtPlxuICAgICAgICBcIlwiXCJcbiAgICAgICAgPHRkPlxuICAgICAgICAgIDxzZWxlY3QgY2xhc3M9XCJ0eXBlLXNlbGVjdG9yXCI+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiU3RyaW5nXCIgI3tpZl9zdHJpbmcodil9PlN0cmluZzwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIk51bWJlclwiICN7aWZfbnVtYmVyKHYpfT5OdW1iZXI8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJCb29sZWFuXCI+Qm9vbGVhbjwvb3B0aW9uPlxuICAgICAgICAgIDwvc2VsZWN0PiBcbiAgICAgICAgPC90ZD5cbiAgICAgICAgXCJcIlwiXG4gICAgICB2YWx1ZXMgPSBsaW5lLnNwbGl0ICcsJ1xuICAgICAgKHRkKHZhbHVlKSBmb3IgdmFsdWUgaW4gdmFsdWVzKS5qb2luIFwiXCJcbiAgICBcblxuICAgIGJ1aWxkX2RhdGFfcm93ID0gKGxpbmUpIC0+XG4gICAgICB0ZCA9ICh2KSAtPiBcIjx0ZD4je3Z9PC90ZD5cIlxuICAgICAgdmFsdWVzID0gbGluZS5zcGxpdCAnLCdcbiAgICAgICh0ZCh2YWx1ZSkgZm9yIHZhbHVlIGluIHZhbHVlcykuam9pbiBcIlwiXG4gICAgXG5cbiAgICBzID0gXCJcIlwiXG4gICAgPHRhYmxlIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZCBzaWx2ZXI7XCI+XG4gICAgICA8dGhlYWQ+XG4gICAgICAgIDx0cj4je2J1aWxkX2ZpZWxkX25hbWVzX3JvdyhsaW5lc1swXSl9PC90cj5cbiAgICAgICAgPHRyPiN7YnVpbGRfZmllbGRfdHlwZXNfcm93KGxpbmVzWzFdKX08L3RyPlxuICAgICAgPC90aGVhZD5cbiAgICAgIDx0Ym9keT5cbiAgICAgICAgPHRyPiN7YnVpbGRfZGF0YV9yb3cobGluZXNbMV0pfTwvdHI+XG4gICAgICAgIDx0cj4je2J1aWxkX2RhdGFfcm93KGxpbmVzWzJdKX08L3RyPlxuICAgICAgPC90Ym9keT5cbiAgICA8L3RhYmxlPlxuICAgIFwiXCJcIlxuICAgIGNvbnNvbGUubG9nIHNcbiAgICBjb250YWluZXIuaHRtbCBzXG4gICAgcmV0dXJuXG4gIHJldHVyblxuXG5cbiMgcHJlcGFyZSBHVUkgYWZ0ZXIgdGhlIHVzZXIgc2VsZWN0cyBhIGZpbGVcbmluaXRfdWkgPSAtPlxuICBmaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob29zZUZpbGVCdXR0b24nKS5maWxlc1swXVxuICBzaG93X3Byb2dyZXNzIDAsMFxuICBidWlsZF9oZWFkX3RhYmxlKClcblxuICBcbiMgY29udmVydHMgdGV4dCB0byBKU09OLiBQcm9jZXNzb3IgY29uc3VtaW5nIG9wZXJhdGlvbi4gVE9ETzogbW92ZSB0byBhIHdvcmtlci5cbnByZXBhcmVfanNvbiA9KGluZGV4LCBsaW5lcykgLT5cbiAgaWYgbm90IGxpbmVzIHRoZW4gcmV0dXJuXG4gIHJlcyA9IFtdXG4gIGlmIGluZGV4IGlzIDBcbiAgICBmaWVsZF9uYW1lcyA9IGxpbmVzWzBdLnJlcGxhY2UoL1wiL2csJycpLnNwbGl0ICcsJ1xuICAgIGxpbmVzLnNoaWZ0KClcblxuICBmb3IgbGluZSxpIGluIGxpbmVzXG4gICAgaWYgaW5kZXgraSA+IG1heF9udW1iZXJfb2ZfcmVjb3JkcyB0aGVuIHJldHVybiByZXNcbiAgICBvcGVyYXRpb24gPSB7IGluZGV4OiAgeyBfaW5kZXg6IGluZGV4X25hbWUsIF90eXBlOiB0eXBlX25hbWUsIF9pZDogaW5kZXgraSB9IH1cbiAgICBmaWVsZF92YWx1ZXMgPSBsaW5lLnNwbGl0ICcsJ1xuICAgICNyZWNvcmQgPSBfLm9iamVjdCBmaWVsZF9uYW1lcywgZmllbGRfdmFsdWVzXG4gICAgcmVjb3JkID0gQ1NWLnBhcnNlKGxpbmUsIHtoZWFkZXI6IGZpZWxkX25hbWVzLCBjZWxsRGVsaW1pdGVyOicsJywgY2FzdDogY2FzdCB9KVswXVxuICAgIHJlcy5wdXNoIG9wZXJhdGlvblxuICAgIHJlcy5wdXNoIHJlY29yZFxuXG4gIHJldHVybiByZXNcbiAgXG4gIFxuXG4jIFJlYWRpbmcgbmV4dCBjaHVua1xucmVhZF9saW5lcyA9KGkpIC0+XG4gICNuYXZpZ2F0b3IucmVhZExpbmVzIGksIGxpbmVzX2luX2JhdGNoLCAgbGluZXNSZWFkSGFuZGxlclxuICBuYXZpZ2F0b3IucmVhZFNvbWVMaW5lcyBpLCAgbGluZXNSZWFkSGFuZGxlclxuICByZXR1cm5cblxuXG5cbnNlbmRfanNvbl90b19zZXJ2ZXIgPSAoaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzLCBqc29uKSAtPlxuICBpZiBpbmRleD5tYXhfbnVtYmVyX29mX3JlY29yZHNcbiAgICByZXR1cm5cbiAgaWYganNvbi5sZW5ndGggaXMgMFxuICAgIHJldHVyblxuXG4gIGVzX2NsaWVudC5idWxrIHsgYm9keToganNvbiB9LCAoZXJyLCByZXNwKSA9PlxuXG4gICAgaWYgZXJyXG4gICAgICBhbGVydCBcIlNvcnJ5LCAje2Vyci5tZXNzYWdlfVwiXG4gICAgICBjb25zb2xlLmxvZyBlcnJcbiAgICAgIHJldHVyblxuICAgIGVsc2VcbiAgICAgIHNob3dfcHJvZ3Jlc3MocHJvZ3Jlc3MsIGluZGV4K2pzb24ubGVuZ3RoLzIpICMgbGluZXMubGVuZ3RoKVxuICAgICAgY29uc29sZS5sb2cgXCIgI3tqc29uLmxlbmd0aC8yfSBsaW5lcyBzZW50XCJcbiAgICAgIFxuICAgICAgaWYgZW9mIHRoZW4gcmV0dXJuXG4gICAgICAjIGFkZGluZyBudW1iZXIgb2YgbGluZXMgcmVhZCB0byBmaXJzdCBsaW5lIGluIGN1cnJlbnQgY2h1bmtcbiAgICAgIHJlYWRfbGluZXMgaW5kZXggKyBqc29uLmxlbmd0aC8yICNsaW5lcy5sZW5ndGhcbiAgICAgIHJldHVyblxuICAgIHJldHVyblxuXG4gIHJldHVyblxuXG5cblxuXG4gIFxuIyB3b3JrcyB3aGVuIGEgbmV4dCBwb3J0aW9uIG9mIGZpbGUgaGFzIGJlZW4gcmVhZFxubGluZXNSZWFkSGFuZGxlciA9IChlcnIsIGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcykgLT5cbiAgaWYgZXJyIHRoZW4gIHJldHVyblxuICBpZiBpbmRleD5tYXhfbnVtYmVyX29mX3JlY29yZHNcbiAgICByZXR1cm5cbiAganNvbiA9IHByZXBhcmVfanNvbiBpbmRleCwgbGluZXNcbiAgc2VuZF9qc29uX3RvX3NlcnZlciBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MsIGpzb25cbiAgcmV0dXJuXG5cblxuXG4jIHJldHVybnMgYXJyYXkgb2YgZmVpbGQgdHlwZXMgdG8gc2F2ZSBpbiB0aGUgZ2xvYmFsIGNhc3QgdmFyaWFibGVcbmdldF9maWVsZF90eXBlcyA9KCkgLT5cbiAgc2VscyA9JCgnLnR5cGUtc2VsZWN0b3InKVxuICB0eXBlcyA9IChzZWwudmFsdWUgZm9yIHNlbCBpbiBzZWxzKVxuICByZXR1cm4gdHlwZXNcblxuXG5cbiMgc3RhcnRzIGFjdHVhbGx5IHJlYWQgdGhlIGZpbGUgIFxucmVhZEZpbGUgPSAtPlxuICBob3N0cyA9ICQoJyNob3N0cycpLnZhbCgpXG4gIGluZGV4X25hbWUgPSAkKCcjaW5kZXhOYW1lJykudmFsKClcbiAgdHlwZV9uYW1lID0gJCgnI3R5cGVOYW1lJykudmFsKClcblxuICBlc19jbGllbnQgPSBuZXcgJC5lcy5DbGllbnQgaG9zdHM6IGhvc3RzXG4gIFxuICBjYXN0ID0gZ2V0X2ZpZWxkX3R5cGVzKClcblxuICBuYXZpZ2F0b3IgPSBuZXcgRmlsZU5hdmlnYXRvcihmaWxlLCBvcHRpb25zKVxuICByZWFkX2xpbmVzIDBcbiAgcmV0dXJuXG5cblxuXG4jIGFzc2lnbiBoYW5kbGVycyB0byBVSSBcbiQoJyNjaG9vc2VGaWxlQnV0dG9uJykuY2hhbmdlID0+IGluaXRfdWkoKVxuJCgnI3JlYWRGaWxlQnV0dG9uJykuY2xpY2sgPT4gcmVhZEZpbGUoKVxuXG5cbiJdfQ==
