(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var FileNavigator;

FileNavigator = function(file, options) {
  var decode, getProgress, lastPosition, navigator, readChunk, self, size;
  self = this;
  size = file.size;
  file.navigator = this;
  lastPosition = 0;
  getProgress = function() {
    var progress;
    if (!size || size === 0) {
      return 0;
    }
    progress = parseInt(100 * lastPosition / size);
    if (progress > 100) {
      return 100;
    } else {
      return progress;
    }
  };
  readChunk = function(offset, length, callback) {
    var reader;
    lastPosition = offset + length;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      var buffer;
      buffer = void 0;
      if (reader.result) {
        buffer = new Int8Array(reader.result, 0);
        buffer.slice = buffer.subarray;
      }
      callback(progress.err, buffer, progress.loaded);
    };
    reader.readAsArrayBuffer(file.slice(offset, offset + length));
  };
  decode = function(buffer, callback) {
    var reader;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      callback(progress.currentTarget.result);
    };
    reader.readAsText(new Blob([buffer]));
  };
  navigator = new LineNavigator(readChunk, decode, options);
  self.getMilestones = navigator.getMilestones;
  self.readSomeLines = function(index, callback) {
    navigator.readSomeLines(index, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.readLines = function(index, count, callback) {
    navigator.readLines(index, count, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.find = navigator.find;
  self.findAll = navigator.findAll;
  self.getSize = function(callback) {
    return callback(file ? file.size : 0);
  };
};

module.exports = FileNavigator;



},{}],2:[function(require,module,exports){
var FileNavigator, build_head_table2, cast, clear, convert_lines_to_json2, es_client, field_names, file, get_field_types, hosts, index_name, init_ui, linesReadHandler2, lines_in_batch, max_number_of_records, navigator, options, readFile, read_lines2, send_json_to_server2, show_progress, status, type_name, worker;

FileNavigator = require('./filenavigator.coffee');

hosts = "localhost:9200";

index_name = "govwiki";

type_name = "govs";

es_client = void 0;

field_names = [];

navigator = void 0;

file = void 0;

lines_in_batch = 10000;

max_number_of_records = 2000000000;

options = {
  chunkSize: 1024 * 512 * 1
};

cast = void 0;

worker = void 0;

show_progress = function(progress, number) {
  var bar;
  bar = $(".progress-bar");
  bar.css("width", progress + "%");
  bar.text(progress + "%");
  $('#counter').text(number);
  return console.log(number + " : lines " + progress + "%");
};

build_head_table2 = function() {
  var container, head_navigator;
  container = $('#head_table_container');
  container.html("");
  head_navigator = new FileNavigator(file, {
    chunkSize: 1024 * 128
  });
  head_navigator.readLines(0, 3, function(err, index, lines, eof, progress) {
    var build_id_radio, build_table_body, build_table_row, build_type_selector, s;
    if (err) {
      return;
    }
    build_id_radio = function(name, i) {
      return "<input type=\"radio\" name=\"id_field\" value=\"" + name + "\">";
    };
    build_type_selector = function(name, i) {
      var if_number, if_string, v;
      if_string = function(v) {
        if (!v) {
          return "selected";
        }
        if (('' + v).indexOf('"') > -1) {
          return "selected";
        }
        return "";
      };
      if_number = function(v) {
        if (if_string(v) === "selected") {
          return "";
        } else {
          return "selected";
        }
      };
      v = lines[1].split(',')[i];
      return "<select class=\"type-selector form-control\" style=\"width:100px;\">\n  <option value=\"String\" " + (if_string(v)) + ">String</option>\n  <option value=\"Number\" " + (if_number(v)) + ">Number</option>\n  <option value=\"Boolean\">Boolean</option>\n</select> ";
    };
    build_table_row = function(name, i) {
      return "<tr>\n  <td class=\"first-column\">" + (build_id_radio(name, i)) + "</td>\n  <td>" + name + "</td>\n  <td style=\"width:120px;\">" + (build_type_selector(name, i)) + "</td>\n  <td>" + (lines[1].split(',')[i]) + "</td>\n</tr>";
    };
    build_table_body = function() {
      var i, name;
      return ((function() {
        var j, len, ref, results;
        ref = lines[0].replace(/"/g, '').split(',');
        results = [];
        for (i = j = 0, len = ref.length; j < len; i = ++j) {
          name = ref[i];
          results.push(build_table_row(name, i));
        }
        return results;
      })()).join('');
    };
    s = "<table class=\"table table-condensed\">\n  <thead>\n    <tr>\n      <th class=\"first-column\" style=\"width:70px;\"><input type=\"radio\" name=\"id_field\" value=\"\" checked>&nbsp;_id</th>\n      <th style=\"width:250px;\">name</th>\n      <th style=\"width:120px;\">type</th>\n      <th>sample</th>\n    </tr>\n  </thead>\n  <tbody>\n    " + (build_table_body()) + "\n  </tbody>\n</table>";
    container.html(s);
  });
};

init_ui = function() {
  file = document.getElementById('chooseFileButton').files[0];
  clear(worker);
  show_progress(0, 0);
  build_head_table2();
  $('.step-3').show();
  return $('.step-4').hide();
};

convert_lines_to_json2 = function(prm) {
  var field_values, i, j, len, line, operation, record, ref, res;
  importScripts('js/csv.js');
  if (!prm.lines) {
    return;
  }
  res = [];
  if (prm.index === 0) {
    prm.field_names = prm.lines[0].replace(/"/g, '').split(',');
    prm.lines.shift();
  }
  ref = prm.lines;
  for (i = j = 0, len = ref.length; j < len; i = ++j) {
    line = ref[i];
    if (prm.index + i > prm.max_number_of_records) {
      return res;
    }
    operation = {
      index: {
        _index: prm.index_name,
        _type: prm.type_name,
        _id: prm.index + i
      }
    };
    field_values = line.split(',');
    record = CSV.parse(line, {
      header: prm.field_names,
      cellDelimiter: ',',
      cast: prm.cast
    })[0];
    res.push(operation);
    res.push(record);
  }
  return res;
};

read_lines2 = function(i) {
  status('reading text');
  navigator.readSomeLines(i, linesReadHandler2);
};

send_json_to_server2 = function(index, lines, eof, progress, json) {
  if (index > max_number_of_records) {
    return;
  }
  if (json.length === 0) {
    return;
  }
  status((json.length / 2) + " sending");
  es_client.bulk({
    body: json
  }, (function(_this) {
    return function(err, resp) {
      if (err) {
        clear(worker);
        alert("Sorry, " + err.message);
        console.log(err);
        return;
      } else {
        status("");
        show_progress(progress, index + json.length / 2);
        if (eof) {
          clear(worker);
          return;
        }
        read_lines2(index + json.length / 2);
        return;
      }
    };
  })(this));
};

linesReadHandler2 = function(err, index, lines, eof, progress) {
  if (err) {
    clear(worker);
    return;
  }
  if (index > max_number_of_records) {
    clear(worker);
    return;
  }
  status(lines.length + " converting");
  worker.convert_lines_to_json2({
    index: index,
    lines: lines,
    field_names: field_names,
    max_number_of_records: max_number_of_records,
    index_name: index_name,
    type_name: type_name,
    cast: cast
  }).then(function(json) {
    send_json_to_server2(index, lines, eof, progress, json);
  });
};

clear = function(worker) {
  if (worker) {
    return worker.close();
  }
};

get_field_types = function() {
  var sel, sels, types;
  sels = $('.type-selector');
  types = (function() {
    var j, len, results;
    results = [];
    for (j = 0, len = sels.length; j < len; j++) {
      sel = sels[j];
      results.push(sel.value);
    }
    return results;
  })();
  return types;
};

readFile = function() {
  clear(worker);
  worker = cw({
    convert_lines_to_json2: convert_lines_to_json2
  });
  hosts = $('#hosts').val();
  index_name = $('#indexName').val();
  type_name = $('#typeName').val();
  es_client = new $.es.Client({
    hosts: hosts
  });
  cast = get_field_types();
  navigator = new FileNavigator(file, options);
  read_lines2(0);
  $('.step-4').show();
};

status = function(text) {
  return $('#status').text(text);
};

$('#chooseFileButton').change((function(_this) {
  return function() {
    return init_ui();
  };
})(this));

$('#readFileButton').click((function(_this) {
  return function() {
    return readFile();
  };
})(this));

$('.step-3').hide();

$('.step-4').hide();



},{"./filenavigator.coffee":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL2ZpbGVuYXZpZ2F0b3IuY29mZmVlIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL21haW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDUUEsSUFBQSxhQUFBOztBQUFBLGFBQUEsR0FBZ0IsU0FBQyxJQUFELEVBQU8sT0FBUCxHQUFBO0FBQ2QsTUFBQSxtRUFBQTtBQUFBLEVBQUEsSUFBQSxHQUFPLElBQVAsQ0FBQTtBQUFBLEVBQ0EsSUFBQSxHQUFPLElBQUksQ0FBQyxJQURaLENBQUE7QUFBQSxFQUVBLElBQUksQ0FBQyxTQUFMLEdBQWlCLElBRmpCLENBQUE7QUFBQSxFQUlBLFlBQUEsR0FBZSxDQUpmLENBQUE7QUFBQSxFQU1BLFdBQUEsR0FBYyxTQUFBLEdBQUE7QUFDWixRQUFBLFFBQUE7QUFBQSxJQUFBLElBQUcsQ0FBQSxJQUFBLElBQVMsSUFBQSxLQUFRLENBQXBCO0FBQ0UsYUFBTyxDQUFQLENBREY7S0FBQTtBQUFBLElBRUEsUUFBQSxHQUFXLFFBQUEsQ0FBUyxHQUFBLEdBQU0sWUFBTixHQUFxQixJQUE5QixDQUZYLENBQUE7QUFHQSxJQUFBLElBQUcsUUFBQSxHQUFXLEdBQWQ7YUFBdUIsSUFBdkI7S0FBQSxNQUFBO2FBQWdDLFNBQWhDO0tBSlk7RUFBQSxDQU5kLENBQUE7QUFBQSxFQWdCQSxTQUFBLEdBQVksU0FBQyxNQUFELEVBQVMsTUFBVCxFQUFpQixRQUFqQixHQUFBO0FBQ1YsUUFBQSxNQUFBO0FBQUEsSUFBQSxZQUFBLEdBQWUsTUFBQSxHQUFT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QSxDQUFFLFNBQUYsQ0FBWSxDQUFDLElBQWIsQ0FBQSxDQWxQQSxDQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuIyBBbGxvd3MgdG8gbmF2aWdhdGUgZ2l2ZW4gc291cmNlcyBsaW5lcywgc2F2aW5nIG1pbGVzdG9uZXMgdG8gb3B0aW1pemUgcmFuZG9tIHJlYWRpbmdcbiMgb3B0aW9ucyA9IHtcbiMgICAgICAgIG1pbGVzdG9uZXM6IFtdLCAgICAgICAgIC8vIG9wdGlvbmFsOiBhcnJheSBvZiBtaWxlc3RvbmVzLCB3aGljaCBjYW4gYmUgb2J0YWluZWQgYnkgZ2V0TWlsZXN0b25lcygpIG1ldGhvZCBhbmQgc3RvcmVkIHRvIHNwZWVkIHVwIHJhbmRvbSByZWFkaW5nIGluIGZ1dHVyZVxuIyAgICAgICAgY2h1bmtTaXplOiAxMDI0ICogNCwgICAgLy8gb3B0aW9uYWw6IHNpemUgb2YgY2h1bmsgdG8gcmVhZCBhdCBvbmNlXG4jIH1cblxuXG5GaWxlTmF2aWdhdG9yID0gKGZpbGUsIG9wdGlvbnMpIC0+XG4gIHNlbGYgPSB0aGlzXG4gIHNpemUgPSBmaWxlLnNpemVcbiAgZmlsZS5uYXZpZ2F0b3IgPSB0aGlzXG4gICMgcmV1c2UgbWlsZXN0b25lcyBsYXRlclxuICBsYXN0UG9zaXRpb24gPSAwXG5cbiAgZ2V0UHJvZ3Jlc3MgPSAtPlxuICAgIGlmICFzaXplIG9yIHNpemUgPT0gMFxuICAgICAgcmV0dXJuIDBcbiAgICBwcm9ncmVzcyA9IHBhcnNlSW50KDEwMCAqIGxhc3RQb3NpdGlvbiAvIHNpemUpXG4gICAgaWYgcHJvZ3Jlc3MgPiAxMDAgdGhlbiAxMDAgZWxzZSBwcm9ncmVzc1xuXG5cblxuICAjIGNhbGxiYWNrKGVyciwgYnVmZmVyLCBieXRlc1JlYWQpXG5cbiAgcmVhZENodW5rID0gKG9mZnNldCwgbGVuZ3RoLCBjYWxsYmFjaykgLT5cbiAgICBsYXN0UG9zaXRpb24gPSBvZmZzZXQgKyBsZW5ndGhcbiAgICByZWFkZXIgPSBuZXcgRmlsZVJlYWRlclxuXG4gICAgcmVhZGVyLm9ubG9hZGVuZCA9IChwcm9ncmVzcykgLT5cbiAgICAgIGJ1ZmZlciA9IHVuZGVmaW5lZFxuICAgICAgaWYgcmVhZGVyLnJlc3VsdFxuICAgICAgICBidWZmZXIgPSBuZXcgSW50OEFycmF5KHJlYWRlci5yZXN1bHQsIDApXG4gICAgICAgIGJ1ZmZlci5zbGljZSA9IGJ1ZmZlci5zdWJhcnJheVxuICAgICAgY2FsbGJhY2sgcHJvZ3Jlc3MuZXJyLCBidWZmZXIsIHByb2dyZXNzLmxvYWRlZFxuICAgICAgcmV0dXJuXG5cbiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIgZmlsZS5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aClcbiAgICByZXR1cm5cblxuXG5cbiAgIyBjYWxsYmFjayhzdHIpO1xuXG4gIGRlY29kZSA9IChidWZmZXIsIGNhbGxiYWNrKSAtPlxuICAgIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyXG5cbiAgICByZWFkZXIub25sb2FkZW5kID0gKHByb2dyZXNzKSAtPlxuICAgICAgY2FsbGJhY2sgcHJvZ3Jlc3MuY3VycmVudFRhcmdldC5yZXN1bHRcbiAgICAgIHJldHVyblxuXG4gICAgcmVhZGVyLnJlYWRBc1RleHQgbmV3IEJsb2IoWyBidWZmZXIgXSlcbiAgICByZXR1cm5cblxuICBuYXZpZ2F0b3IgPSBuZXcgTGluZU5hdmlnYXRvcihyZWFkQ2h1bmssIGRlY29kZSwgb3B0aW9ucylcblxuXG5cblxuICAjIFJldHVybnMgY3VycmVudCBtaWxlc3RvbmVzLCB0byBzcGVlZCB1cCBmaWxlIHJhbmRvbSByZWFkaW5nIGluIGZ1dHVyZVxuXG4gIHNlbGYuZ2V0TWlsZXN0b25lcyA9IG5hdmlnYXRvci5nZXRNaWxlc3RvbmVzXG5cblxuXG4gICMgUmVhZHMgb3B0aW1hbCBudW1iZXIgb2YgbGluZXNcbiAgIyBjYWxsYmFjazogZnVuY3Rpb24oZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpXG4gICMgd2hlcmUgcHJvZ3Jlc3MgaXMgMC0xMDAgJSBvZiBmaWxlIFxuXG4gIHNlbGYucmVhZFNvbWVMaW5lcyA9IChpbmRleCwgY2FsbGJhY2spIC0+XG4gICAgbmF2aWdhdG9yLnJlYWRTb21lTGluZXMgaW5kZXgsIChlcnIsIGluZGV4LCBsaW5lcywgZW9mKSAtPlxuICAgICAgY2FsbGJhY2sgZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgZ2V0UHJvZ3Jlc3MoKVxuICAgICAgcmV0dXJuXG4gICAgcmV0dXJuXG5cblxuXG4gICMgUmVhZHMgZXhhY3QgYW1vdW50IG9mIGxpbmVzXG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzKVxuICAjIHdoZXJlIHByb2dyZXNzIGlzIDAtMTAwICUgb2YgZmlsZSBcblxuICBzZWxmLnJlYWRMaW5lcyA9IChpbmRleCwgY291bnQsIGNhbGxiYWNrKSAtPlxuICAgIG5hdmlnYXRvci5yZWFkTGluZXMgaW5kZXgsIGNvdW50LCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZikgLT5cbiAgICAgIGNhbGxiYWNrIGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIGdldFByb2dyZXNzKClcbiAgICAgIHJldHVyblxuICAgIHJldHVyblxuXG5cblxuICAjIEZpbmRzIG5leHQgb2NjdXJyZW5jZSBvZiByZWd1bGFyIGV4cHJlc3Npb24gc3RhcnRpbmcgZnJvbSBnaXZlbiBpbmRleFxuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihlcnIsIGluZGV4LCBtYXRjaHtvZmZzZXQsIGxlbmd0aCwgbGluZX0pXG4gICMgb2Zmc2V0IGFuZCBsZW5ndGggYXJlIGJlbG9uZyB0byBtYXRjaCBpbnNpZGUgbGluZVxuXG4gIHNlbGYuZmluZCA9IG5hdmlnYXRvci5maW5kXG5cblxuXG4gICMgRmluZHMgYWxsIG9jY3VycmVuY2VzIG9mIHJlZ3VsYXIgZXhwcmVzc2lvbiBzdGFydGluZyBmcm9tIGdpdmVuIGluZGV4XG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbWl0SGl0LCByZXN1bHRzKVxuICAjIHJlc3VsdCBpcyBhbiBhcnJheSBvZiBvYmplY3RzIHdpdGggZm9sbG93aW5nIHN0cnVjdHVyZSB7aW5kZXgsIG9mZnNldCwgbGVuZ3RoLCBsaW5lfVxuICAjIG9mZnNldCBhbmQgbGVuZ3RoIGFyZSBiZWxvbmcgdG8gbWF0Y2ggaW5zaWRlIGxpbmVcblxuICBzZWxmLmZpbmRBbGwgPSBuYXZpZ2F0b3IuZmluZEFsbFxuXG5cbiAgIyBSZXR1cm5zIHNpemUgb2YgZmlsZSBpbiBieXRlc1xuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihzaXplKVxuXG4gIHNlbGYuZ2V0U2l6ZSA9IChjYWxsYmFjaykgLT5cbiAgICBjYWxsYmFjayBpZiBmaWxlIHRoZW4gZmlsZS5zaXplIGVsc2UgMFxuXG4gIHJldHVyblxuXG5cbm1vZHVsZS5leHBvcnRzPUZpbGVOYXZpZ2F0b3JcbiIsIkZpbGVOYXZpZ2F0b3IgPSByZXF1aXJlICcuL2ZpbGVuYXZpZ2F0b3IuY29mZmVlJ1xuIyBHbG9iYWxzXG5ob3N0cyA9IFwibG9jYWxob3N0OjkyMDBcIlxuaW5kZXhfbmFtZSA9IFwiZ292d2lraVwiXG50eXBlX25hbWUgPSBcImdvdnNcIlxuZXNfY2xpZW50ID0gdW5kZWZpbmVkXG5maWVsZF9uYW1lcyA9IFtdXG5cbm5hdmlnYXRvciA9IHVuZGVmaW5lZFxuZmlsZSA9IHVuZGVmaW5lZFxubGluZXNfaW5fYmF0Y2ggPTEwMDAwXG5tYXhfbnVtYmVyX29mX3JlY29yZHM9MjAwMDAwMDAwMFxuXG5vcHRpb25zID0ge2NodW5rU2l6ZTogMTAyNCAqIDUxMiAqIDF9ICMgY2h1bmtTaXplOiAxMDI0ICogMTAyNCAqIDRcbmNhc3QgPSB1bmRlZmluZWRcblxud29ya2VyPXVuZGVmaW5lZFxuXG4jID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuXG5zaG93X3Byb2dyZXNzID0gKHByb2dyZXNzLG51bWJlcikgLT5cbiAgYmFyPSQoXCIucHJvZ3Jlc3MtYmFyXCIpXG4gIGJhci5jc3MgXCJ3aWR0aFwiLCBcIiN7cHJvZ3Jlc3N9JVwiXG4gIGJhci50ZXh0IFwiI3twcm9ncmVzc30lXCJcbiAgJCgnI2NvdW50ZXInKS50ZXh0IG51bWJlclxuICBjb25zb2xlLmxvZyBcIiN7bnVtYmVyfSA6IGxpbmVzICN7cHJvZ3Jlc3N9JVwiXG5cblxuXG5idWlsZF9oZWFkX3RhYmxlMiA9KCkgLT5cbiAgY29udGFpbmVyID0gJCgnI2hlYWRfdGFibGVfY29udGFpbmVyJylcbiAgY29udGFpbmVyLmh0bWwgXCJcIlxuICBoZWFkX25hdmlnYXRvciA9IG5ldyBGaWxlTmF2aWdhdG9yIGZpbGUsICB7Y2h1bmtTaXplOiAxMDI0ICogMTI4IH1cbiAgaGVhZF9uYXZpZ2F0b3IucmVhZExpbmVzIDAsIDMsIChlcnIsIGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcykgLT5cblxuICAgIGlmIGVyciB0aGVuICByZXR1cm5cbiAgICBcbiAgICBidWlsZF9pZF9yYWRpbyA9IChuYW1lLGkpIC0+XG4gICAgICBcIlwiXCJcbiAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiaWRfZmllbGRcIiB2YWx1ZT1cIiN7bmFtZX1cIj5cbiAgICAgIFwiXCJcIlxuXG4gICAgYnVpbGRfdHlwZV9zZWxlY3RvciA9IChuYW1lLGkpIC0+XG4gICAgICBcbiAgICAgIGlmX3N0cmluZyA9KHYpIC0+XG4gICAgICAgIGlmIG5vdCB2IHRoZW4gcmV0dXJuIFwic2VsZWN0ZWRcIlxuICAgICAgICBpZiAoJycrdikuaW5kZXhPZignXCInKSA+IC0xIHRoZW4gcmV0dXJuIFwic2VsZWN0ZWRcIlxuICAgICAgICBcIlwiXG4gICAgICBcbiAgICAgIGlmX251bWJlciA9KHYpIC0+XG4gICAgICAgIGlmIGlmX3N0cmluZyh2KSBpcyBcInNlbGVjdGVkXCIgIHRoZW4gXCJcIiBlbHNlIFwic2VsZWN0ZWRcIlxuICAgICAgXG4gICAgICB2ID0gbGluZXNbMV0uc3BsaXQoJywnKVtpXVxuICAgICAgXCJcIlwiXG4gICAgICA8c2VsZWN0IGNsYXNzPVwidHlwZS1zZWxlY3RvciBmb3JtLWNvbnRyb2xcIiBzdHlsZT1cIndpZHRoOjEwMHB4O1wiPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiU3RyaW5nXCIgI3tpZl9zdHJpbmcodil9PlN0cmluZzwvb3B0aW9uPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiTnVtYmVyXCIgI3tpZl9udW1iZXIodil9Pk51bWJlcjwvb3B0aW9uPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiQm9vbGVhblwiPkJvb2xlYW48L29wdGlvbj5cbiAgICAgIDwvc2VsZWN0PiBcbiAgICAgIFwiXCJcIlxuXG4gICAgYnVpbGRfdGFibGVfcm93ID0gKG5hbWUsaSkgLT5cbiAgICAgIFwiXCJcIlxuICAgICAgPHRyPlxuICAgICAgICA8dGQgY2xhc3M9XCJmaXJzdC1jb2x1bW5cIj4je2J1aWxkX2lkX3JhZGlvKG5hbWUsaSl9PC90ZD5cbiAgICAgICAgPHRkPiN7bmFtZX08L3RkPlxuICAgICAgICA8dGQgc3R5bGU9XCJ3aWR0aDoxMjBweDtcIj4je2J1aWxkX3R5cGVfc2VsZWN0b3IobmFtZSxpKX08L3RkPlxuICAgICAgICA8dGQ+I3tsaW5lc1sxXS5zcGxpdCgnLCcpW2ldfTwvdGQ+XG4gICAgICA8L3RyPlxuICAgICAgXCJcIlwiXG4gICAgXG5cbiAgICBidWlsZF90YWJsZV9ib2R5ID0gLT5cbiAgICAgIChidWlsZF90YWJsZV9yb3cobmFtZSxpKSBmb3IgbmFtZSwgaSBpbiBsaW5lc1swXS5yZXBsYWNlKC9cIi9nLCcnKS5zcGxpdCgnLCcpKVxuICAgICAgLmpvaW4oJycpXG4gICAgXG4gICAgXG4gICAgcyA9IFwiXCJcIlxuICAgIDx0YWJsZSBjbGFzcz1cInRhYmxlIHRhYmxlLWNvbmRlbnNlZFwiPlxuICAgICAgPHRoZWFkPlxuICAgICAgICA8dHI+XG4gICAgICAgICAgPHRoIGNsYXNzPVwiZmlyc3QtY29sdW1uXCIgc3R5bGU9XCJ3aWR0aDo3MHB4O1wiPjxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiaWRfZmllbGRcIiB2YWx1ZT1cIlwiIGNoZWNrZWQ+Jm5ic3A7X2lkPC90aD5cbiAgICAgICAgICA8dGggc3R5bGU9XCJ3aWR0aDoyNTBweDtcIj5uYW1lPC90aD5cbiAgICAgICAgICA8dGggc3R5bGU9XCJ3aWR0aDoxMjBweDtcIj50eXBlPC90aD5cbiAgICAgICAgICA8dGg+c2FtcGxlPC90aD5cbiAgICAgICAgPC90cj5cbiAgICAgIDwvdGhlYWQ+XG4gICAgICA8dGJvZHk+XG4gICAgICAgICN7YnVpbGRfdGFibGVfYm9keSgpfVxuICAgICAgPC90Ym9keT5cbiAgICA8L3RhYmxlPlxuICAgIFwiXCJcIlxuXG4gICAgY29udGFpbmVyLmh0bWwgc1xuICAgIHJldHVyblxuXG5cbiAgcmV0dXJuXG5cbiMgcHJlcGFyZSBHVUkgYWZ0ZXIgdGhlIHVzZXIgc2VsZWN0cyBhIGZpbGVcbmluaXRfdWkgPSAtPlxuICBmaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob29zZUZpbGVCdXR0b24nKS5maWxlc1swXVxuICBjbGVhciB3b3JrZXJcbiAgc2hvd19wcm9ncmVzcyAwLDBcbiAgYnVpbGRfaGVhZF90YWJsZTIoKVxuICAkKCcuc3RlcC0zJykuc2hvdygpXG4gICQoJy5zdGVwLTQnKS5oaWRlKClcblxuICBcbiMgY29udmVydHMgdGV4dCB0byBKU09OLiBQcm9jZXNzb3IgY29uc3VtaW5nIG9wZXJhdGlvbi4gVE9ETzogbW92ZSB0byBhIHdvcmtlci5cbiMgcHJtIGlzIHsgaW5kZXg6aW5kZXgsIGxpbmVzOmxpbmVzLCBmaWVsZF9uYW1lczpmaWVsZF9uYW1lcywgXG4jIG1heF9udW1iZXJfb2ZfcmVjb3JkczptYXhfbnVtYmVyX29mX3JlY29yZHMsIGluZGV4X25hbWU6aW5kZXhfbmFtZSwgdHlwZV9uYW1lOnR5cGVfbmFtZSwgY2FzdDpjYXN0IH1cbmNvbnZlcnRfbGluZXNfdG9fanNvbjIgPShwcm0pIC0+XG4gIGltcG9ydFNjcmlwdHMoJ2pzL2Nzdi5qcycpXG4gIGlmIG5vdCBwcm0ubGluZXMgdGhlbiByZXR1cm5cbiAgcmVzID0gW11cbiAgaWYgcHJtLmluZGV4IGlzIDBcbiAgICBwcm0uZmllbGRfbmFtZXMgPSBwcm0ubGluZXNbMF0ucmVwbGFjZSgvXCIvZywnJykuc3BsaXQgJywnXG4gICAgcHJtLmxpbmVzLnNoaWZ0KClcblxuICBmb3IgbGluZSxpIGluIHBybS5saW5lc1xuICAgIGlmIHBybS5pbmRleCtpID4gcHJtLm1heF9udW1iZXJfb2ZfcmVjb3JkcyB0aGVuIHJldHVybiByZXNcbiAgICBvcGVyYXRpb24gPSB7IGluZGV4OiAgeyBfaW5kZXg6IHBybS5pbmRleF9uYW1lLCBfdHlwZTogcHJtLnR5cGVfbmFtZSwgX2lkOiBwcm0uaW5kZXgraSB9IH1cbiAgICBmaWVsZF92YWx1ZXMgPSBsaW5lLnNwbGl0ICcsJ1xuICAgICNyZWNvcmQgPSBfLm9iamVjdCBmaWVsZF9uYW1lcywgZmllbGRfdmFsdWVzXG4gICAgcmVjb3JkID0gQ1NWLnBhcnNlKGxpbmUsIHtoZWFkZXI6IHBybS5maWVsZF9uYW1lcywgY2VsbERlbGltaXRlcjonLCcsIGNhc3Q6IHBybS5jYXN0IH0pWzBdXG4gICAgcmVzLnB1c2ggb3BlcmF0aW9uXG4gICAgcmVzLnB1c2ggcmVjb3JkXG5cbiAgcmV0dXJuIHJlc1xuXG5cblxuIyBSZWFkaW5nIG5leHQgY2h1bmtcbnJlYWRfbGluZXMyID0oaSkgLT5cbiAgc3RhdHVzICdyZWFkaW5nIHRleHQnXG4gICNuYXZpZ2F0b3IucmVhZExpbmVzIGksIGxpbmVzX2luX2JhdGNoLCAgbGluZXNSZWFkSGFuZGxlclxuICBuYXZpZ2F0b3IucmVhZFNvbWVMaW5lcyBpLCAgbGluZXNSZWFkSGFuZGxlcjJcbiAgcmV0dXJuXG5cblxuc2VuZF9qc29uX3RvX3NlcnZlcjIgPSAoaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzLCBqc29uKSAtPlxuICBpZiBpbmRleD5tYXhfbnVtYmVyX29mX3JlY29yZHNcbiAgICByZXR1cm5cbiAgaWYganNvbi5sZW5ndGggaXMgMFxuICAgIHJldHVyblxuXG4gIHN0YXR1cyBcIiN7anNvbi5sZW5ndGgvMn0gc2VuZGluZ1wiXG4gIGVzX2NsaWVudC5idWxrIHsgYm9keToganNvbiB9LCAoZXJyLCByZXNwKSA9PlxuXG4gICAgaWYgZXJyXG4gICAgICBjbGVhciB3b3JrZXJcbiAgICAgIGFsZXJ0IFwiU29ycnksICN7ZXJyLm1lc3NhZ2V9XCJcbiAgICAgIGNvbnNvbGUubG9nIGVyclxuICAgICAgcmV0dXJuXG4gICAgZWxzZVxuICAgICAgc3RhdHVzIFwiXCJcbiAgICAgIHNob3dfcHJvZ3Jlc3MocHJvZ3Jlc3MsIGluZGV4K2pzb24ubGVuZ3RoLzIpICMgbGluZXMubGVuZ3RoKVxuICAgICAgI2NvbnNvbGUubG9nIFwiICN7anNvbi5sZW5ndGgvMn0gbGluZXMgc2VudFwiXG4gICAgICBcbiAgICAgIGlmIGVvZlxuICAgICAgICBjbGVhciB3b3JrZXJcbiAgICAgICAgcmV0dXJuXG4gICAgICAjIGFkZGluZyBudW1iZXIgb2YgbGluZXMgcmVhZCB0byBmaXJzdCBsaW5lIGluIGN1cnJlbnQgY2h1bmtcbiAgICAgIHJlYWRfbGluZXMyIGluZGV4ICsganNvbi5sZW5ndGgvMiAjbGluZXMubGVuZ3RoXG4gICAgICByZXR1cm5cbiAgICByZXR1cm5cblxuICByZXR1cm5cblxuXG5cbiAgXG4jIHdvcmtzIHdoZW4gYSBuZXh0IHBvcnRpb24gb2YgZmlsZSBoYXMgYmVlbiByZWFkXG5saW5lc1JlYWRIYW5kbGVyMiA9IChlcnIsIGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcykgLT5cbiAgaWYgZXJyXG4gICAgY2xlYXIgd29ya2VyXG4gICAgcmV0dXJuXG4gICAgICAgIFxuICBpZiBpbmRleD5tYXhfbnVtYmVyX29mX3JlY29yZHNcbiAgICBjbGVhciB3b3JrZXJcbiAgICByZXR1cm5cbiAgXG4gIHN0YXR1cyBcIiN7bGluZXMubGVuZ3RofSBjb252ZXJ0aW5nXCJcbiAgd29ya2VyLmNvbnZlcnRfbGluZXNfdG9fanNvbjIoe1xuICAgIGluZGV4OmluZGV4LFxuICAgIGxpbmVzOmxpbmVzLFxuICAgIGZpZWxkX25hbWVzOmZpZWxkX25hbWVzLFxuICAgIG1heF9udW1iZXJfb2ZfcmVjb3JkczptYXhfbnVtYmVyX29mX3JlY29yZHMsXG4gICAgaW5kZXhfbmFtZTppbmRleF9uYW1lLFxuICAgIHR5cGVfbmFtZTp0eXBlX25hbWUsXG4gICAgY2FzdDpjYXN0XG4gIH0pXG4gIC50aGVuIChqc29uKSAtPlxuICAgIHNlbmRfanNvbl90b19zZXJ2ZXIyIGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcywganNvblxuICAgIHJldHVyblxuXG4gIHJldHVyblxuXG5jbGVhciA9KHdvcmtlciktPlxuICBpZiB3b3JrZXJcbiAgICB3b3JrZXIuY2xvc2UoKVxuXG5cblxuIyByZXR1cm5zIGFycmF5IG9mIGZlaWxkIHR5cGVzIHRvIHNhdmUgaW4gdGhlIGdsb2JhbCBjYXN0IHZhcmlhYmxlXG5nZXRfZmllbGRfdHlwZXMgPSgpIC0+XG4gIHNlbHMgPSQoJy50eXBlLXNlbGVjdG9yJylcbiAgdHlwZXMgPSAoc2VsLnZhbHVlIGZvciBzZWwgaW4gc2VscylcbiAgcmV0dXJuIHR5cGVzXG5cblxuXG4jIHN0YXJ0cyBhY3R1YWxseSByZWFkIHRoZSBmaWxlICBcbnJlYWRGaWxlID0gLT5cbiAgY2xlYXIgd29ya2VyXG4gIHdvcmtlciA9IGN3IGNvbnZlcnRfbGluZXNfdG9fanNvbjI6IGNvbnZlcnRfbGluZXNfdG9fanNvbjJcblxuICBob3N0cyA9ICQoJyNob3N0cycpLnZhbCgpXG4gIGluZGV4X25hbWUgPSAkKCcjaW5kZXhOYW1lJykudmFsKClcbiAgdHlwZV9uYW1lID0gJCgnI3R5cGVOYW1lJykudmFsKClcblxuICBlc19jbGllbnQgPSBuZXcgJC5lcy5DbGllbnQgaG9zdHM6IGhvc3RzXG4gIFxuICBjYXN0ID0gZ2V0X2ZpZWxkX3R5cGVzKClcblxuICBuYXZpZ2F0b3IgPSBuZXcgRmlsZU5hdmlnYXRvcihmaWxlLCBvcHRpb25zKVxuICByZWFkX2xpbmVzMiAwXG4gIFxuICAkKCcuc3RlcC00Jykuc2hvdygpXG4gIHJldHVyblxuXG5zdGF0dXMgPSh0ZXh0KSAtPlxuICAkKCcjc3RhdHVzJykudGV4dCh0ZXh0KVxuXG4jIGFzc2lnbiBoYW5kbGVycyB0byBVSSBcbiQoJyNjaG9vc2VGaWxlQnV0dG9uJykuY2hhbmdlID0+IGluaXRfdWkoKVxuJCgnI3JlYWRGaWxlQnV0dG9uJykuY2xpY2sgPT4gcmVhZEZpbGUoKVxuXG4kKCcuc3RlcC0zJykuaGlkZSgpXG4kKCcuc3RlcC00JykuaGlkZSgpXG5cblxuIl19
