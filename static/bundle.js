(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var FileNavigator;

FileNavigator = function(file, options) {
  var decode, getProgress, lastPosition, navigator, readChunk, self, size;
  self = this;
  size = file.size;
  file.navigator = this;
  lastPosition = 0;
  getProgress = function() {
    var progress;
    if (!size || size === 0) {
      return 0;
    }
    progress = parseInt(100 * lastPosition / size);
    if (progress > 100) {
      return 100;
    } else {
      return progress;
    }
  };
  readChunk = function(offset, length, callback) {
    var reader;
    lastPosition = offset + length;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      var buffer;
      buffer = void 0;
      if (reader.result) {
        buffer = new Int8Array(reader.result, 0);
        buffer.slice = buffer.subarray;
      }
      callback(progress.err, buffer, progress.loaded);
    };
    reader.readAsArrayBuffer(file.slice(offset, offset + length));
  };
  decode = function(buffer, callback) {
    var reader;
    reader = new FileReader;
    reader.onloadend = function(progress) {
      callback(progress.currentTarget.result);
    };
    reader.readAsText(new Blob([buffer]));
  };
  navigator = new LineNavigator(readChunk, decode, options);
  self.getMilestones = navigator.getMilestones;
  self.readSomeLines = function(index, callback) {
    navigator.readSomeLines(index, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.readLines = function(index, count, callback) {
    navigator.readLines(index, count, function(err, index, lines, eof) {
      callback(err, index, lines, eof, getProgress());
    });
  };
  self.find = navigator.find;
  self.findAll = navigator.findAll;
  self.getSize = function(callback) {
    return callback(file ? file.size : 0);
  };
};

module.exports = FileNavigator;



},{}],2:[function(require,module,exports){
var FileNavigator, build_head_table2, cast, es_client, field_names, file, get_field_types, hosts, index_name, init_ui, linesReadHandler, lines_in_batch, max_number_of_records, navigator, options, prepare_json, readFile, read_lines, send_json_to_server, show_progress, type_name;

FileNavigator = require('./filenavigator.coffee');

hosts = "localhost:9200";

index_name = "govwiki";

type_name = "govs";

es_client = void 0;

field_names = [];

navigator = void 0;

file = void 0;

lines_in_batch = 10000;

max_number_of_records = 2000000000;

options = {
  chunkSize: 1024 * 512 * 1
};

cast = void 0;

show_progress = function(progress, number) {
  var bar;
  bar = $(".progress-bar");
  bar.css("width", progress + "%");
  bar.text(progress + "%");
  $('#counter').text(number);
  return console.log(number + " : lines " + progress + "%");
};

build_head_table2 = function() {
  var container, head_navigator;
  container = $('#head_table_container');
  container.html("");
  head_navigator = new FileNavigator(file, {
    chunkSize: 1024 * 128
  });
  head_navigator.readLines(0, 3, function(err, index, lines, eof, progress) {
    var build_id_radio, build_table_body, build_table_row, build_type_selector, s;
    if (err) {
      return;
    }
    build_id_radio = function(name, i) {
      return "<input type=\"radio\" name=\"id_field\" value=\"" + name + "\">";
    };
    build_type_selector = function(name, i) {
      var if_number, if_string, v;
      if_string = function(v) {
        if (!v) {
          return "selected";
        }
        if (('' + v).indexOf('"') > -1) {
          return "selected";
        }
        return "";
      };
      if_number = function(v) {
        if (if_string(v) === "selected") {
          return "";
        } else {
          return "selected";
        }
      };
      v = lines[1].split(',')[i];
      return "<select class=\"type-selector form-control\" style=\"width:100px;\">\n  <option value=\"String\" " + (if_string(v)) + ">String</option>\n  <option value=\"Number\" " + (if_number(v)) + ">Number</option>\n  <option value=\"Boolean\">Boolean</option>\n</select> ";
    };
    build_table_row = function(name, i) {
      return "<tr>\n  <td>" + (build_id_radio(name, i)) + "</td>\n  <td>" + name + "</td>\n  <td style=\"width:120px;\">" + (build_type_selector(name, i)) + "</td>\n  <td>" + (lines[1].split(',')[i]) + "</td>\n</tr>";
    };
    build_table_body = function() {
      var i, name;
      return ((function() {
        var j, len, ref, results;
        ref = lines[0].replace(/"/g, '').split(',');
        results = [];
        for (i = j = 0, len = ref.length; j < len; i = ++j) {
          name = ref[i];
          results.push(build_table_row(name, i));
        }
        return results;
      })()).join('');
    };
    s = "<table class=\"table table-condensed\">\n  <thead>\n    <tr>\n      <th style=\"width:70px;\"><input type=\"radio\" name=\"id_field\" value=\"\" checked>&nbsp;_id</th>\n      <th style=\"width:250px;\">name</th>\n      <th style=\"width:120px;\">type</th>\n      <th>sample</th>\n    </tr>\n  </thead>\n  <tbody>\n    " + (build_table_body()) + "\n  </tbody>\n</table>";
    container.html(s);
  });
};

init_ui = function() {
  file = document.getElementById('chooseFileButton').files[0];
  show_progress(0, 0);
  build_head_table2();
  $('.step-3').show();
  return $('.step-4').hide();
};

prepare_json = function(index, lines) {
  var field_values, i, j, len, line, operation, record, res;
  if (!lines) {
    return;
  }
  res = [];
  if (index === 0) {
    field_names = lines[0].replace(/"/g, '').split(',');
    lines.shift();
  }
  for (i = j = 0, len = lines.length; j < len; i = ++j) {
    line = lines[i];
    if (index + i > max_number_of_records) {
      return res;
    }
    operation = {
      index: {
        _index: index_name,
        _type: type_name,
        _id: index + i
      }
    };
    field_values = line.split(',');
    record = CSV.parse(line, {
      header: field_names,
      cellDelimiter: ',',
      cast: cast
    })[0];
    res.push(operation);
    res.push(record);
  }
  return res;
};

read_lines = function(i) {
  navigator.readSomeLines(i, linesReadHandler);
};

send_json_to_server = function(index, lines, eof, progress, json) {
  if (index > max_number_of_records) {
    return;
  }
  if (json.length === 0) {
    return;
  }
  es_client.bulk({
    body: json
  }, (function(_this) {
    return function(err, resp) {
      if (err) {
        alert("Sorry, " + err.message);
        console.log(err);
        return;
      } else {
        show_progress(progress, index + json.length / 2);
        console.log(" " + (json.length / 2) + " lines sent");
        if (eof) {
          return;
        }
        read_lines(index + json.length / 2);
        return;
      }
    };
  })(this));
};

linesReadHandler = function(err, index, lines, eof, progress) {
  var json;
  if (err) {
    return;
  }
  if (index > max_number_of_records) {
    return;
  }
  json = prepare_json(index, lines);
  send_json_to_server(index, lines, eof, progress, json);
};

get_field_types = function() {
  var sel, sels, types;
  sels = $('.type-selector');
  types = (function() {
    var j, len, results;
    results = [];
    for (j = 0, len = sels.length; j < len; j++) {
      sel = sels[j];
      results.push(sel.value);
    }
    return results;
  })();
  return types;
};

readFile = function() {
  hosts = $('#hosts').val();
  index_name = $('#indexName').val();
  type_name = $('#typeName').val();
  es_client = new $.es.Client({
    hosts: hosts
  });
  cast = get_field_types();
  navigator = new FileNavigator(file, options);
  read_lines(0);
  $('.step-4').show();
};

$('#chooseFileButton').change((function(_this) {
  return function() {
    return init_ui();
  };
})(this));

$('#readFileButton').click((function(_this) {
  return function() {
    return readFile();
  };
})(this));

$('.step-3').hide();

$('.step-4').hide();



},{"./filenavigator.coffee":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL2ZpbGVuYXZpZ2F0b3IuY29mZmVlIiwiL1VzZXJzL3ZhZGltaXZsZXYvUHJvamVjdHMvX3Byb2plY3RzL2VsYXN0aWNzZWFyY2gtZGF0YS1sb2FkZXIvY29mZmVlL21haW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDUUEsSUFBQSxhQUFBOztBQUFBLGFBQUEsR0FBZ0IsU0FBQyxJQUFELEVBQU8sT0FBUCxHQUFBO0FBQ2QsTUFBQSxtRUFBQTtBQUFBLEVBQUEsSUFBQSxHQUFPLElBQVAsQ0FBQTtBQUFBLEVBQ0EsSUFBQSxHQUFPLElBQUksQ0FBQyxJQURaLENBQUE7QUFBQSxFQUVBLElBQUksQ0FBQyxTQUFMLEdBQWlCLElBRmpCLENBQUE7QUFBQSxFQUlBLFlBQUEsR0FBZSxDQUpmLENBQUE7QUFBQSxFQU1BLFdBQUEsR0FBYyxTQUFBLEdBQUE7QUFDWixRQUFBLFFBQUE7QUFBQSxJQUFBLElBQUcsQ0FBQSxJQUFBLElBQVMsSUFBQSxLQUFRLENBQXBCO0FBQ0UsYUFBTyxDQUFQLENBREY7S0FBQTtBQUFBLElBRUEsUUFBQSxHQUFXLFFBQUEsQ0FBUyxHQUFBLEdBQU0sWUFBTixHQUFxQixJQUE5QixDQUZYLENBQUE7QUFHQSxJQUFBLElBQUcsUUFBQSxHQUFXLEdBQWQ7YUFBdUIsSUFBdkI7S0FBQSxNQUFBO2FBQWdDLFNBQWhDO0tBSlk7RUFBQSxDQU5kLENBQUE7QUFBQSxFQWdCQSxTQUFBLEdBQVksU0FBQyxNQUFELEVBQVMsTUFBVCxFQUFpQixRQUFqQixHQUFBO0FBQ1YsUUFBQSxNQUFBO0FBQUEsSUFBQSxZQUFBLEdBQWUsTUFBQSxHQUFT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bnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcbiMgQWxsb3dzIHRvIG5hdmlnYXRlIGdpdmVuIHNvdXJjZXMgbGluZXMsIHNhdmluZyBtaWxlc3RvbmVzIHRvIG9wdGltaXplIHJhbmRvbSByZWFkaW5nXG4jIG9wdGlvbnMgPSB7XG4jICAgICAgICBtaWxlc3RvbmVzOiBbXSwgICAgICAgICAvLyBvcHRpb25hbDogYXJyYXkgb2YgbWlsZXN0b25lcywgd2hpY2ggY2FuIGJlIG9idGFpbmVkIGJ5IGdldE1pbGVzdG9uZXMoKSBtZXRob2QgYW5kIHN0b3JlZCB0byBzcGVlZCB1cCByYW5kb20gcmVhZGluZyBpbiBmdXR1cmVcbiMgICAgICAgIGNodW5rU2l6ZTogMTAyNCAqIDQsICAgIC8vIG9wdGlvbmFsOiBzaXplIG9mIGNodW5rIHRvIHJlYWQgYXQgb25jZVxuIyB9XG5cblxuRmlsZU5hdmlnYXRvciA9IChmaWxlLCBvcHRpb25zKSAtPlxuICBzZWxmID0gdGhpc1xuICBzaXplID0gZmlsZS5zaXplXG4gIGZpbGUubmF2aWdhdG9yID0gdGhpc1xuICAjIHJldXNlIG1pbGVzdG9uZXMgbGF0ZXJcbiAgbGFzdFBvc2l0aW9uID0gMFxuXG4gIGdldFByb2dyZXNzID0gLT5cbiAgICBpZiAhc2l6ZSBvciBzaXplID09IDBcbiAgICAgIHJldHVybiAwXG4gICAgcHJvZ3Jlc3MgPSBwYXJzZUludCgxMDAgKiBsYXN0UG9zaXRpb24gLyBzaXplKVxuICAgIGlmIHByb2dyZXNzID4gMTAwIHRoZW4gMTAwIGVsc2UgcHJvZ3Jlc3NcblxuXG5cbiAgIyBjYWxsYmFjayhlcnIsIGJ1ZmZlciwgYnl0ZXNSZWFkKVxuXG4gIHJlYWRDaHVuayA9IChvZmZzZXQsIGxlbmd0aCwgY2FsbGJhY2spIC0+XG4gICAgbGFzdFBvc2l0aW9uID0gb2Zmc2V0ICsgbGVuZ3RoXG4gICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXJcblxuICAgIHJlYWRlci5vbmxvYWRlbmQgPSAocHJvZ3Jlc3MpIC0+XG4gICAgICBidWZmZXIgPSB1bmRlZmluZWRcbiAgICAgIGlmIHJlYWRlci5yZXN1bHRcbiAgICAgICAgYnVmZmVyID0gbmV3IEludDhBcnJheShyZWFkZXIucmVzdWx0LCAwKVxuICAgICAgICBidWZmZXIuc2xpY2UgPSBidWZmZXIuc3ViYXJyYXlcbiAgICAgIGNhbGxiYWNrIHByb2dyZXNzLmVyciwgYnVmZmVyLCBwcm9ncmVzcy5sb2FkZWRcbiAgICAgIHJldHVyblxuXG4gICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyIGZpbGUuc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBsZW5ndGgpXG4gICAgcmV0dXJuXG5cblxuXG4gICMgY2FsbGJhY2soc3RyKTtcblxuICBkZWNvZGUgPSAoYnVmZmVyLCBjYWxsYmFjaykgLT5cbiAgICByZWFkZXIgPSBuZXcgRmlsZVJlYWRlclxuXG4gICAgcmVhZGVyLm9ubG9hZGVuZCA9IChwcm9ncmVzcykgLT5cbiAgICAgIGNhbGxiYWNrIHByb2dyZXNzLmN1cnJlbnRUYXJnZXQucmVzdWx0XG4gICAgICByZXR1cm5cblxuICAgIHJlYWRlci5yZWFkQXNUZXh0IG5ldyBCbG9iKFsgYnVmZmVyIF0pXG4gICAgcmV0dXJuXG5cbiAgbmF2aWdhdG9yID0gbmV3IExpbmVOYXZpZ2F0b3IocmVhZENodW5rLCBkZWNvZGUsIG9wdGlvbnMpXG5cblxuXG5cbiAgIyBSZXR1cm5zIGN1cnJlbnQgbWlsZXN0b25lcywgdG8gc3BlZWQgdXAgZmlsZSByYW5kb20gcmVhZGluZyBpbiBmdXR1cmVcblxuICBzZWxmLmdldE1pbGVzdG9uZXMgPSBuYXZpZ2F0b3IuZ2V0TWlsZXN0b25lc1xuXG5cblxuICAjIFJlYWRzIG9wdGltYWwgbnVtYmVyIG9mIGxpbmVzXG4gICMgY2FsbGJhY2s6IGZ1bmN0aW9uKGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzKVxuICAjIHdoZXJlIHByb2dyZXNzIGlzIDAtMTAwICUgb2YgZmlsZSBcblxuICBzZWxmLnJlYWRTb21lTGluZXMgPSAoaW5kZXgsIGNhbGxiYWNrKSAtPlxuICAgIG5hdmlnYXRvci5yZWFkU29tZUxpbmVzIGluZGV4LCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZikgLT5cbiAgICAgIGNhbGxiYWNrIGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIGdldFByb2dyZXNzKClcbiAgICAgIHJldHVyblxuICAgIHJldHVyblxuXG5cblxuICAjIFJlYWRzIGV4YWN0IGFtb3VudCBvZiBsaW5lc1xuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihlcnIsIGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcylcbiAgIyB3aGVyZSBwcm9ncmVzcyBpcyAwLTEwMCAlIG9mIGZpbGUgXG5cbiAgc2VsZi5yZWFkTGluZXMgPSAoaW5kZXgsIGNvdW50LCBjYWxsYmFjaykgLT5cbiAgICBuYXZpZ2F0b3IucmVhZExpbmVzIGluZGV4LCBjb3VudCwgKGVyciwgaW5kZXgsIGxpbmVzLCBlb2YpIC0+XG4gICAgICBjYWxsYmFjayBlcnIsIGluZGV4LCBsaW5lcywgZW9mLCBnZXRQcm9ncmVzcygpXG4gICAgICByZXR1cm5cbiAgICByZXR1cm5cblxuXG5cbiAgIyBGaW5kcyBuZXh0IG9jY3VycmVuY2Ugb2YgcmVndWxhciBleHByZXNzaW9uIHN0YXJ0aW5nIGZyb20gZ2l2ZW4gaW5kZXhcbiAgIyBjYWxsYmFjazogZnVuY3Rpb24oZXJyLCBpbmRleCwgbWF0Y2h7b2Zmc2V0LCBsZW5ndGgsIGxpbmV9KVxuICAjIG9mZnNldCBhbmQgbGVuZ3RoIGFyZSBiZWxvbmcgdG8gbWF0Y2ggaW5zaWRlIGxpbmVcblxuICBzZWxmLmZpbmQgPSBuYXZpZ2F0b3IuZmluZFxuXG5cblxuICAjIEZpbmRzIGFsbCBvY2N1cnJlbmNlcyBvZiByZWd1bGFyIGV4cHJlc3Npb24gc3RhcnRpbmcgZnJvbSBnaXZlbiBpbmRleFxuICAjIGNhbGxiYWNrOiBmdW5jdGlvbihlcnIsIGluZGV4LCBsaW1pdEhpdCwgcmVzdWx0cylcbiAgIyByZXN1bHQgaXMgYW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIGZvbGxvd2luZyBzdHJ1Y3R1cmUge2luZGV4LCBvZmZzZXQsIGxlbmd0aCwgbGluZX1cbiAgIyBvZmZzZXQgYW5kIGxlbmd0aCBhcmUgYmVsb25nIHRvIG1hdGNoIGluc2lkZSBsaW5lXG5cbiAgc2VsZi5maW5kQWxsID0gbmF2aWdhdG9yLmZpbmRBbGxcblxuXG4gICMgUmV0dXJucyBzaXplIG9mIGZpbGUgaW4gYnl0ZXNcbiAgIyBjYWxsYmFjazogZnVuY3Rpb24oc2l6ZSlcblxuICBzZWxmLmdldFNpemUgPSAoY2FsbGJhY2spIC0+XG4gICAgY2FsbGJhY2sgaWYgZmlsZSB0aGVuIGZpbGUuc2l6ZSBlbHNlIDBcblxuICByZXR1cm5cblxuXG5tb2R1bGUuZXhwb3J0cz1GaWxlTmF2aWdhdG9yXG4iLCJGaWxlTmF2aWdhdG9yID0gcmVxdWlyZSAnLi9maWxlbmF2aWdhdG9yLmNvZmZlZSdcblxuIyBHbG9iYWxzXG5ob3N0cyA9IFwibG9jYWxob3N0OjkyMDBcIlxuaW5kZXhfbmFtZSA9IFwiZ292d2lraVwiXG50eXBlX25hbWUgPSBcImdvdnNcIlxuZXNfY2xpZW50ID0gdW5kZWZpbmVkXG5maWVsZF9uYW1lcyA9IFtdXG5cbm5hdmlnYXRvciA9IHVuZGVmaW5lZFxuZmlsZSA9IHVuZGVmaW5lZFxubGluZXNfaW5fYmF0Y2ggPTEwMDAwXG5tYXhfbnVtYmVyX29mX3JlY29yZHM9MjAwMDAwMDAwMFxuXG5vcHRpb25zID0ge2NodW5rU2l6ZTogMTAyNCAqIDUxMiAqIDF9ICMgY2h1bmtTaXplOiAxMDI0ICogMTAyNCAqIDRcbmNhc3QgPSB1bmRlZmluZWRcblxuIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cblxuc2hvd19wcm9ncmVzcyA9IChwcm9ncmVzcyxudW1iZXIpIC0+XG4gIGJhcj0kKFwiLnByb2dyZXNzLWJhclwiKVxuICBiYXIuY3NzIFwid2lkdGhcIiwgXCIje3Byb2dyZXNzfSVcIlxuICBiYXIudGV4dCBcIiN7cHJvZ3Jlc3N9JVwiXG4gICQoJyNjb3VudGVyJykudGV4dCBudW1iZXJcbiAgY29uc29sZS5sb2cgXCIje251bWJlcn0gOiBsaW5lcyAje3Byb2dyZXNzfSVcIlxuXG5cblxuYnVpbGRfaGVhZF90YWJsZTIgPSgpIC0+XG4gIGNvbnRhaW5lciA9ICQoJyNoZWFkX3RhYmxlX2NvbnRhaW5lcicpXG4gIGNvbnRhaW5lci5odG1sIFwiXCJcbiAgaGVhZF9uYXZpZ2F0b3IgPSBuZXcgRmlsZU5hdmlnYXRvciBmaWxlLCAge2NodW5rU2l6ZTogMTAyNCAqIDEyOCB9XG4gIGhlYWRfbmF2aWdhdG9yLnJlYWRMaW5lcyAwLCAzLCAoZXJyLCBpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MpIC0+XG5cbiAgICBpZiBlcnIgdGhlbiAgcmV0dXJuXG4gICAgXG4gICAgYnVpbGRfaWRfcmFkaW8gPSAobmFtZSxpKSAtPlxuICAgICAgXCJcIlwiXG4gICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImlkX2ZpZWxkXCIgdmFsdWU9XCIje25hbWV9XCI+XG4gICAgICBcIlwiXCJcblxuICAgIGJ1aWxkX3R5cGVfc2VsZWN0b3IgPSAobmFtZSxpKSAtPlxuICAgICAgXG4gICAgICBpZl9zdHJpbmcgPSh2KSAtPlxuICAgICAgICBpZiBub3QgdiB0aGVuIHJldHVybiBcInNlbGVjdGVkXCJcbiAgICAgICAgaWYgKCcnK3YpLmluZGV4T2YoJ1wiJykgPiAtMSB0aGVuIHJldHVybiBcInNlbGVjdGVkXCJcbiAgICAgICAgXCJcIlxuICAgICAgXG4gICAgICBpZl9udW1iZXIgPSh2KSAtPlxuICAgICAgICBpZiBpZl9zdHJpbmcodikgaXMgXCJzZWxlY3RlZFwiICB0aGVuIFwiXCIgZWxzZSBcInNlbGVjdGVkXCJcbiAgICAgIFxuICAgICAgdiA9IGxpbmVzWzFdLnNwbGl0KCcsJylbaV1cbiAgICAgIFwiXCJcIlxuICAgICAgPHNlbGVjdCBjbGFzcz1cInR5cGUtc2VsZWN0b3IgZm9ybS1jb250cm9sXCIgc3R5bGU9XCJ3aWR0aDoxMDBweDtcIj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlN0cmluZ1wiICN7aWZfc3RyaW5nKHYpfT5TdHJpbmc8L29wdGlvbj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIk51bWJlclwiICN7aWZfbnVtYmVyKHYpfT5OdW1iZXI8L29wdGlvbj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIkJvb2xlYW5cIj5Cb29sZWFuPC9vcHRpb24+XG4gICAgICA8L3NlbGVjdD4gXG4gICAgICBcIlwiXCJcblxuICAgIGJ1aWxkX3RhYmxlX3JvdyA9IChuYW1lLGkpIC0+XG4gICAgICBcIlwiXCJcbiAgICAgIDx0cj5cbiAgICAgICAgPHRkPiN7YnVpbGRfaWRfcmFkaW8obmFtZSxpKX08L3RkPlxuICAgICAgICA8dGQ+I3tuYW1lfTwvdGQ+XG4gICAgICAgIDx0ZCBzdHlsZT1cIndpZHRoOjEyMHB4O1wiPiN7YnVpbGRfdHlwZV9zZWxlY3RvcihuYW1lLGkpfTwvdGQ+XG4gICAgICAgIDx0ZD4je2xpbmVzWzFdLnNwbGl0KCcsJylbaV19PC90ZD5cbiAgICAgIDwvdHI+XG4gICAgICBcIlwiXCJcbiAgICBcblxuICAgIGJ1aWxkX3RhYmxlX2JvZHkgPSAtPlxuICAgICAgKGJ1aWxkX3RhYmxlX3JvdyhuYW1lLGkpIGZvciBuYW1lLCBpIGluIGxpbmVzWzBdLnJlcGxhY2UoL1wiL2csJycpLnNwbGl0KCcsJykpXG4gICAgICAuam9pbignJylcbiAgICBcbiAgICBcbiAgICBzID0gXCJcIlwiXG4gICAgPHRhYmxlIGNsYXNzPVwidGFibGUgdGFibGUtY29uZGVuc2VkXCI+XG4gICAgICA8dGhlYWQ+XG4gICAgICAgIDx0cj5cbiAgICAgICAgICA8dGggc3R5bGU9XCJ3aWR0aDo3MHB4O1wiPjxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiaWRfZmllbGRcIiB2YWx1ZT1cIlwiIGNoZWNrZWQ+Jm5ic3A7X2lkPC90aD5cbiAgICAgICAgICA8dGggc3R5bGU9XCJ3aWR0aDoyNTBweDtcIj5uYW1lPC90aD5cbiAgICAgICAgICA8dGggc3R5bGU9XCJ3aWR0aDoxMjBweDtcIj50eXBlPC90aD5cbiAgICAgICAgICA8dGg+c2FtcGxlPC90aD5cbiAgICAgICAgPC90cj5cbiAgICAgIDwvdGhlYWQ+XG4gICAgICA8dGJvZHk+XG4gICAgICAgICN7YnVpbGRfdGFibGVfYm9keSgpfVxuICAgICAgPC90Ym9keT5cbiAgICA8L3RhYmxlPlxuICAgIFwiXCJcIlxuXG4gICAgY29udGFpbmVyLmh0bWwgc1xuICAgIHJldHVyblxuXG5cbiAgcmV0dXJuXG5cbiMgcHJlcGFyZSBHVUkgYWZ0ZXIgdGhlIHVzZXIgc2VsZWN0cyBhIGZpbGVcbmluaXRfdWkgPSAtPlxuICBmaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob29zZUZpbGVCdXR0b24nKS5maWxlc1swXVxuICBzaG93X3Byb2dyZXNzIDAsMFxuICBidWlsZF9oZWFkX3RhYmxlMigpXG4gICQoJy5zdGVwLTMnKS5zaG93KClcbiAgJCgnLnN0ZXAtNCcpLmhpZGUoKVxuXG4gIFxuIyBjb252ZXJ0cyB0ZXh0IHRvIEpTT04uIFByb2Nlc3NvciBjb25zdW1pbmcgb3BlcmF0aW9uLiBUT0RPOiBtb3ZlIHRvIGEgd29ya2VyLlxucHJlcGFyZV9qc29uID0oaW5kZXgsIGxpbmVzKSAtPlxuICBpZiBub3QgbGluZXMgdGhlbiByZXR1cm5cbiAgcmVzID0gW11cbiAgaWYgaW5kZXggaXMgMFxuICAgIGZpZWxkX25hbWVzID0gbGluZXNbMF0ucmVwbGFjZSgvXCIvZywnJykuc3BsaXQgJywnXG4gICAgbGluZXMuc2hpZnQoKVxuXG4gIGZvciBsaW5lLGkgaW4gbGluZXNcbiAgICBpZiBpbmRleCtpID4gbWF4X251bWJlcl9vZl9yZWNvcmRzIHRoZW4gcmV0dXJuIHJlc1xuICAgIG9wZXJhdGlvbiA9IHsgaW5kZXg6ICB7IF9pbmRleDogaW5kZXhfbmFtZSwgX3R5cGU6IHR5cGVfbmFtZSwgX2lkOiBpbmRleCtpIH0gfVxuICAgIGZpZWxkX3ZhbHVlcyA9IGxpbmUuc3BsaXQgJywnXG4gICAgI3JlY29yZCA9IF8ub2JqZWN0IGZpZWxkX25hbWVzLCBmaWVsZF92YWx1ZXNcbiAgICByZWNvcmQgPSBDU1YucGFyc2UobGluZSwge2hlYWRlcjogZmllbGRfbmFtZXMsIGNlbGxEZWxpbWl0ZXI6JywnLCBjYXN0OiBjYXN0IH0pWzBdXG4gICAgcmVzLnB1c2ggb3BlcmF0aW9uXG4gICAgcmVzLnB1c2ggcmVjb3JkXG5cbiAgcmV0dXJuIHJlc1xuICBcbiAgXG5cbiMgUmVhZGluZyBuZXh0IGNodW5rXG5yZWFkX2xpbmVzID0oaSkgLT5cbiAgI25hdmlnYXRvci5yZWFkTGluZXMgaSwgbGluZXNfaW5fYmF0Y2gsICBsaW5lc1JlYWRIYW5kbGVyXG4gIG5hdmlnYXRvci5yZWFkU29tZUxpbmVzIGksICBsaW5lc1JlYWRIYW5kbGVyXG4gIHJldHVyblxuXG5cblxuc2VuZF9qc29uX3RvX3NlcnZlciA9IChpbmRleCwgbGluZXMsIGVvZiwgcHJvZ3Jlc3MsIGpzb24pIC0+XG4gIGlmIGluZGV4Pm1heF9udW1iZXJfb2ZfcmVjb3Jkc1xuICAgIHJldHVyblxuICBpZiBqc29uLmxlbmd0aCBpcyAwXG4gICAgcmV0dXJuXG5cbiAgZXNfY2xpZW50LmJ1bGsgeyBib2R5OiBqc29uIH0sIChlcnIsIHJlc3ApID0+XG5cbiAgICBpZiBlcnJcbiAgICAgIGFsZXJ0IFwiU29ycnksICN7ZXJyLm1lc3NhZ2V9XCJcbiAgICAgIGNvbnNvbGUubG9nIGVyclxuICAgICAgcmV0dXJuXG4gICAgZWxzZVxuICAgICAgc2hvd19wcm9ncmVzcyhwcm9ncmVzcywgaW5kZXgranNvbi5sZW5ndGgvMikgIyBsaW5lcy5sZW5ndGgpXG4gICAgICBjb25zb2xlLmxvZyBcIiAje2pzb24ubGVuZ3RoLzJ9IGxpbmVzIHNlbnRcIlxuICAgICAgXG4gICAgICBpZiBlb2YgdGhlbiByZXR1cm5cbiAgICAgICMgYWRkaW5nIG51bWJlciBvZiBsaW5lcyByZWFkIHRvIGZpcnN0IGxpbmUgaW4gY3VycmVudCBjaHVua1xuICAgICAgcmVhZF9saW5lcyBpbmRleCArIGpzb24ubGVuZ3RoLzIgI2xpbmVzLmxlbmd0aFxuICAgICAgcmV0dXJuXG4gICAgcmV0dXJuXG5cbiAgcmV0dXJuXG5cblxuXG5cbiAgXG4jIHdvcmtzIHdoZW4gYSBuZXh0IHBvcnRpb24gb2YgZmlsZSBoYXMgYmVlbiByZWFkXG5saW5lc1JlYWRIYW5kbGVyID0gKGVyciwgaW5kZXgsIGxpbmVzLCBlb2YsIHByb2dyZXNzKSAtPlxuICBpZiBlcnIgdGhlbiAgcmV0dXJuXG4gIGlmIGluZGV4Pm1heF9udW1iZXJfb2ZfcmVjb3Jkc1xuICAgIHJldHVyblxuICBqc29uID0gcHJlcGFyZV9qc29uIGluZGV4LCBsaW5lc1xuICBzZW5kX2pzb25fdG9fc2VydmVyIGluZGV4LCBsaW5lcywgZW9mLCBwcm9ncmVzcywganNvblxuICByZXR1cm5cblxuXG5cbiMgcmV0dXJucyBhcnJheSBvZiBmZWlsZCB0eXBlcyB0byBzYXZlIGluIHRoZSBnbG9iYWwgY2FzdCB2YXJpYWJsZVxuZ2V0X2ZpZWxkX3R5cGVzID0oKSAtPlxuICBzZWxzID0kKCcudHlwZS1zZWxlY3RvcicpXG4gIHR5cGVzID0gKHNlbC52YWx1ZSBmb3Igc2VsIGluIHNlbHMpXG4gIHJldHVybiB0eXBlc1xuXG5cblxuIyBzdGFydHMgYWN0dWFsbHkgcmVhZCB0aGUgZmlsZSAgXG5yZWFkRmlsZSA9IC0+XG4gIGhvc3RzID0gJCgnI2hvc3RzJykudmFsKClcbiAgaW5kZXhfbmFtZSA9ICQoJyNpbmRleE5hbWUnKS52YWwoKVxuICB0eXBlX25hbWUgPSAkKCcjdHlwZU5hbWUnKS52YWwoKVxuXG4gIGVzX2NsaWVudCA9IG5ldyAkLmVzLkNsaWVudCBob3N0czogaG9zdHNcbiAgXG4gIGNhc3QgPSBnZXRfZmllbGRfdHlwZXMoKVxuXG4gIG5hdmlnYXRvciA9IG5ldyBGaWxlTmF2aWdhdG9yKGZpbGUsIG9wdGlvbnMpXG4gIHJlYWRfbGluZXMgMFxuICBcbiAgJCgnLnN0ZXAtNCcpLnNob3coKVxuICByZXR1cm5cblxuXG5cbiMgYXNzaWduIGhhbmRsZXJzIHRvIFVJIFxuJCgnI2Nob29zZUZpbGVCdXR0b24nKS5jaGFuZ2UgPT4gaW5pdF91aSgpXG4kKCcjcmVhZEZpbGVCdXR0b24nKS5jbGljayA9PiByZWFkRmlsZSgpXG5cbiQoJy5zdGVwLTMnKS5oaWRlKClcbiQoJy5zdGVwLTQnKS5oaWRlKClcblxuXG4iXX0=
